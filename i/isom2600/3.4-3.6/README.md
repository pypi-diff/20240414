# Comparing `tmp/isom2600-3.4.tar.gz` & `tmp/isom2600-3.6.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist\isom2600-3.4.tar", last modified: Sun Apr 14 00:29:39 2024, max compression
+gzip compressed data, was "dist\isom2600-3.6.tar", last modified: Sun Apr 14 01:02:31 2024, max compression
```

## Comparing `isom2600-3.4.tar` & `isom2600-3.6.tar`

### file list

```diff
@@ -1,13 +1,13 @@
-drwxrwxrwx   0        0        0        0 2024-04-14 00:29:39.000000 isom2600-3.4/
--rw-rw-rw-   0        0        0      204 2024-04-14 00:29:39.000000 isom2600-3.4/PKG-INFO
-drwxrwxrwx   0        0        0        0 2024-04-14 00:29:39.000000 isom2600-3.4/isom2600/
--rw-rw-rw-   0        0        0       44 2024-03-15 15:35:38.000000 isom2600-3.4/isom2600/__init__.py
--rw-rw-rw-   0        0        0     2335 2024-04-08 04:26:45.000000 isom2600-3.4/isom2600/data.py
--rw-rw-rw-   0        0        0     9001 2024-04-14 00:29:30.000000 isom2600-3.4/isom2600/regression.py
-drwxrwxrwx   0        0        0        0 2024-04-14 00:29:39.000000 isom2600-3.4/isom2600.egg-info/
--rw-rw-rw-   0        0        0      204 2024-04-14 00:29:39.000000 isom2600-3.4/isom2600.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      197 2024-04-14 00:29:39.000000 isom2600-3.4/isom2600.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2024-04-14 00:29:39.000000 isom2600-3.4/isom2600.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        9 2024-04-14 00:29:39.000000 isom2600-3.4/isom2600.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2024-04-14 00:29:39.000000 isom2600-3.4/setup.cfg
--rw-rw-rw-   0        0        0      146 2024-04-14 00:29:34.000000 isom2600-3.4/setup.py
+drwxrwxrwx   0        0        0        0 2024-04-14 01:02:31.000000 isom2600-3.6/
+-rw-rw-rw-   0        0        0      204 2024-04-14 01:02:31.000000 isom2600-3.6/PKG-INFO
+drwxrwxrwx   0        0        0        0 2024-04-14 01:02:31.000000 isom2600-3.6/isom2600/
+-rw-rw-rw-   0        0        0       44 2024-03-15 15:35:38.000000 isom2600-3.6/isom2600/__init__.py
+-rw-rw-rw-   0        0        0     2335 2024-04-08 04:26:45.000000 isom2600-3.6/isom2600/data.py
+-rw-rw-rw-   0        0        0     9049 2024-04-14 01:01:34.000000 isom2600-3.6/isom2600/regression.py
+drwxrwxrwx   0        0        0        0 2024-04-14 01:02:31.000000 isom2600-3.6/isom2600.egg-info/
+-rw-rw-rw-   0        0        0      204 2024-04-14 01:02:31.000000 isom2600-3.6/isom2600.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      197 2024-04-14 01:02:31.000000 isom2600-3.6/isom2600.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-04-14 01:02:31.000000 isom2600-3.6/isom2600.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        9 2024-04-14 01:02:31.000000 isom2600-3.6/isom2600.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2024-04-14 01:02:31.000000 isom2600-3.6/setup.cfg
+-rw-rw-rw-   0        0        0      146 2024-04-14 01:02:28.000000 isom2600-3.6/setup.py
```

### Comparing `isom2600-3.4/isom2600/data.py` & `isom2600-3.6/isom2600/data.py`

 * *Files identical despite different names*

### Comparing `isom2600-3.4/isom2600/regression.py` & `isom2600-3.6/isom2600/regression.py`

 * *Files 1% similar despite different names*

```diff
@@ -33,531 +33,534 @@
 00000200: 2073 6d2e 4f4c 5328 592c 736d 2e61 6464   sm.OLS(Y,sm.add
 00000210: 5f63 6f6e 7374 616e 7428 5829 292e 6669  _constant(X)).fi
 00000220: 7428 290d 0a20 2020 2053 5345 203d 206d  t()..    SSE = m
 00000230: 6561 6e5f 7371 7561 7265 645f 6572 726f  ean_squared_erro
 00000240: 7228 592c 6d6f 6465 6c5f 6b2e 7072 6564  r(Y,model_k.pred
 00000250: 6963 7428 736d 2e61 6464 5f63 6f6e 7374  ict(sm.add_const
 00000260: 616e 7428 5829 2929 202a 206c 656e 2859  ant(X))) * len(Y
-00000270: 290d 0a20 2020 2052 5f73 7175 6172 6564  )..    R_squared
-00000280: 203d 206d 6f64 656c 5f6b 2e72 7371 7561   = model_k.rsqua
-00000290: 7265 640d 0a20 2020 2061 646a 5f52 3220  red..    adj_R2 
-000002a0: 3d20 6d6f 6465 6c5f 6b2e 7273 7175 6172  = model_k.rsquar
-000002b0: 6564 5f61 646a 0d0a 2020 2020 4149 4320  ed_adj..    AIC 
-000002c0: 3d20 6d6f 6465 6c5f 6b2e 6169 630d 0a20  = model_k.aic.. 
-000002d0: 2020 2042 4943 203d 206d 6f64 656c 5f6b     BIC = model_k
-000002e0: 2e62 6963 0d0a 2020 2020 7265 7475 726e  .bic..    return
-000002f0: 2053 5345 2c20 525f 7371 7561 7265 642c   SSE, R_squared,
-00000300: 2061 646a 5f52 322c 2041 4943 2c20 4249   adj_R2, AIC, BI
-00000310: 430d 0a0d 0a64 6566 2062 6573 745f 7375  C....def best_su
-00000320: 6273 6574 5f73 656c 6563 7469 6f6e 2858  bset_selection(X
-00000330: 2c20 5929 3a0d 0a20 2020 206b 203d 2058  , Y):..    k = X
-00000340: 2e73 6861 7065 5b31 5d0d 0a20 2020 2053  .shape[1]..    S
-00000350: 5345 5f6c 6973 742c 2052 5f73 7175 6172  SE_list, R_squar
-00000360: 6564 5f6c 6973 742c 2061 646a 5f52 325f  ed_list, adj_R2_
-00000370: 6c69 7374 2c20 4149 435f 6c69 7374 2c20  list, AIC_list, 
-00000380: 4249 435f 6c69 7374 2c20 6665 6174 7572  BIC_list, featur
-00000390: 655f 6c69 7374 203d 205b 5d2c 205b 5d2c  e_list = [], [],
-000003a0: 205b 5d2c 205b 5d2c 205b 5d2c 205b 5d0d   [], [], [], [].
-000003b0: 0a20 2020 206e 756d 625f 6665 6174 7572  .    numb_featur
-000003c0: 6573 203d 205b 5d0d 0a0d 0a20 2020 2023  es = []....    #
-000003d0: 204c 6f6f 7069 6e67 206f 7665 7220 6b20   Looping over k 
-000003e0: 3d20 3120 746f 206b 203d 2031 3120 6665  = 1 to k = 11 fe
-000003f0: 6174 7572 6573 2069 6e20 580d 0a20 2020  atures in X..   
-00000400: 2066 6f72 206b 2069 6e20 6e6f 7465 626f   for k in notebo
-00000410: 6f6b 2e74 7261 6e67 6528 312c 206c 656e  ok.trange(1, len
-00000420: 2858 2e63 6f6c 756d 6e73 2920 2b20 312c  (X.columns) + 1,
-00000430: 2064 6573 633d 274c 6f6f 702e 2e2e 2729   desc='Loop...')
-00000440: 3a0d 0a0d 0a20 2020 2020 2020 2023 204c  :....        # L
-00000450: 6f6f 7069 6e67 206f 7665 7220 616c 6c20  ooping over all 
-00000460: 706f 7373 6962 6c65 2063 6f6d 6269 6e61  possible combina
-00000470: 7469 6f6e 733a 2066 726f 6d20 3131 2063  tions: from 11 c
-00000480: 686f 6f73 6520 6b0d 0a20 2020 2020 2020  hoose k..       
-00000490: 2066 6f72 2063 6f6d 626f 2069 6e20 6974   for combo in it
-000004a0: 6572 746f 6f6c 732e 636f 6d62 696e 6174  ertools.combinat
-000004b0: 696f 6e73 2858 2e63 6f6c 756d 6e73 2c20  ions(X.columns, 
-000004c0: 6b29 3a0d 0a20 2020 2020 2020 2020 2020  k):..           
-000004d0: 2074 6d70 5f72 6573 756c 7420 3d20 6669   tmp_result = fi
-000004e0: 745f 6c69 6e65 6172 5f72 6567 2858 5b6c  t_linear_reg(X[l
-000004f0: 6973 7428 636f 6d62 6f29 5d2c 2059 2920  ist(combo)], Y) 
-00000500: 2023 2053 746f 7265 2074 656d 7020 7265   # Store temp re
-00000510: 7375 6c74 0d0a 2020 2020 2020 2020 2020  sult..          
-00000520: 2020 5353 455f 6c69 7374 2e61 7070 656e    SSE_list.appen
-00000530: 6428 746d 705f 7265 7375 6c74 5b30 5d29  d(tmp_result[0])
-00000540: 2020 2320 4164 6473 2069 7473 2061 7267    # Adds its arg
-00000550: 756d 656e 7420 6173 2061 2073 696e 676c  ument as a singl
-00000560: 6520 656c 656d 656e 7420 746f 2074 6865  e element to the
-00000570: 2065 6e64 206f 6620 6120 6c69 7374 2e0d   end of a list..
-00000580: 0a20 2020 2020 2020 2020 2020 2052 5f73  .            R_s
-00000590: 7175 6172 6564 5f6c 6973 742e 6170 7065  quared_list.appe
-000005a0: 6e64 2874 6d70 5f72 6573 756c 745b 315d  nd(tmp_result[1]
-000005b0: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
-000005c0: 646a 5f52 325f 6c69 7374 2e61 7070 656e  dj_R2_list.appen
-000005d0: 6428 746d 705f 7265 7375 6c74 5b32 5d29  d(tmp_result[2])
-000005e0: 0d0a 2020 2020 2020 2020 2020 2020 4149  ..            AI
-000005f0: 435f 6c69 7374 2e61 7070 656e 6428 746d  C_list.append(tm
-00000600: 705f 7265 7375 6c74 5b33 5d29 0d0a 2020  p_result[3])..  
-00000610: 2020 2020 2020 2020 2020 4249 435f 6c69            BIC_li
-00000620: 7374 2e61 7070 656e 6428 746d 705f 7265  st.append(tmp_re
-00000630: 7375 6c74 5b34 5d29 0d0a 2020 2020 2020  sult[4])..      
-00000640: 2020 2020 2020 6665 6174 7572 655f 6c69        feature_li
-00000650: 7374 2e61 7070 656e 6428 636f 6d62 6f29  st.append(combo)
-00000660: 0d0a 2020 2020 2020 2020 2020 2020 6e75  ..            nu
-00000670: 6d62 5f66 6561 7475 7265 732e 6170 7065  mb_features.appe
-00000680: 6e64 286c 656e 2863 6f6d 626f 2929 0d0a  nd(len(combo))..
-00000690: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-000006a0: 5374 6f72 6520 696e 2044 6174 6146 7261  Store in DataFra
-000006b0: 6d65 0d0a 2020 2020 6466 203d 2070 642e  me..    df = pd.
-000006c0: 4461 7461 4672 616d 6528 0d0a 2020 2020  DataFrame(..    
-000006d0: 2020 2020 7b27 6e75 6d62 5f66 6561 7475      {'numb_featu
-000006e0: 7265 7327 3a20 6e75 6d62 5f66 6561 7475  res': numb_featu
-000006f0: 7265 732c 2027 5353 4527 3a20 5353 455f  res, 'SSE': SSE_
-00000700: 6c69 7374 2c20 2752 5f73 7175 6172 6564  list, 'R_squared
-00000710: 273a 2052 5f73 7175 6172 6564 5f6c 6973  ': R_squared_lis
-00000720: 742c 2027 6164 6a5f 5232 273a 2061 646a  t, 'adj_R2': adj
-00000730: 5f52 325f 6c69 7374 2c0d 0a20 2020 2020  _R2_list,..     
-00000740: 2020 2020 2741 4943 273a 2041 4943 5f6c      'AIC': AIC_l
-00000750: 6973 742c 2027 4249 4327 3a20 4249 435f  ist, 'BIC': BIC_
-00000760: 6c69 7374 2c20 2766 6561 7475 7265 7327  list, 'features'
-00000770: 3a20 6665 6174 7572 655f 6c69 7374 7d29  : feature_list})
-00000780: 0d0a 2020 2020 7265 7475 726e 2064 660d  ..    return df.
-00000790: 0a0d 0a64 6566 2066 6f72 7761 7264 5f73  ...def forward_s
-000007a0: 656c 6563 7469 6f6e 2858 2c20 5929 3a0d  election(X, Y):.
-000007b0: 0a20 2020 206b 203d 2058 2e73 6861 7065  .    k = X.shape
-000007c0: 5b31 5d0d 0a0d 0a20 2020 2072 656d 6169  [1]....    remai
-000007d0: 6e69 6e67 5f66 6561 7475 7265 7320 3d20  ning_features = 
-000007e0: 6c69 7374 2858 2e63 6f6c 756d 6e73 2e76  list(X.columns.v
-000007f0: 616c 7565 7329 0d0a 2020 2020 6665 6174  alues)..    feat
-00000800: 7572 6573 203d 205b 5d0d 0a20 2020 2053  ures = []..    S
-00000810: 5345 5f6c 6973 742c 2052 5f73 7175 6172  SE_list, R_squar
-00000820: 6564 5f6c 6973 742c 2061 646a 5f52 325f  ed_list, adj_R2_
-00000830: 6c69 7374 2c20 4149 435f 6c69 7374 2c20  list, AIC_list, 
-00000840: 4249 435f 6c69 7374 203d 205b 6e70 2e69  BIC_list = [np.i
-00000850: 6e66 5d2c 205b 6e70 2e69 6e66 5d2c 205b  nf], [np.inf], [
-00000860: 6e70 2e69 6e66 5d2c 205b 6e70 2e69 6e66  np.inf], [np.inf
-00000870: 5d2c 205b 6e70 2e69 6e66 5d20 2023 2044  ], [np.inf]  # D
-00000880: 7565 2074 6f20 3120 696e 6465 7869 6e67  ue to 1 indexing
-00000890: 206f 6620 7468 6520 6c6f 6f70 2e2e 2e0d   of the loop....
-000008a0: 0a20 2020 2066 6561 7475 7265 735f 6c69  .    features_li
-000008b0: 7374 203d 2064 6963 7428 290d 0a0d 0a20  st = dict().... 
-000008c0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-000008d0: 6528 312c 206b 202b 2031 293a 0d0a 2020  e(1, k + 1):..  
-000008e0: 2020 2020 2020 6265 7374 5f53 5345 203d        best_SSE =
-000008f0: 206e 702e 696e 660d 0a0d 0a20 2020 2020   np.inf....     
-00000900: 2020 2066 6f72 2063 6f6d 626f 2069 6e20     for combo in 
-00000910: 6974 6572 746f 6f6c 732e 636f 6d62 696e  itertools.combin
-00000920: 6174 696f 6e73 2872 656d 6169 6e69 6e67  ations(remaining
-00000930: 5f66 6561 7475 7265 732c 2031 293a 0d0a  _features, 1):..
-00000940: 0d0a 2020 2020 2020 2020 2020 2020 746d  ..            tm
-00000950: 705f 7265 7375 6c74 203d 2066 6974 5f6c  p_result = fit_l
-00000960: 696e 6561 725f 7265 6728 585b 6c69 7374  inear_reg(X[list
-00000970: 2863 6f6d 626f 2920 2b20 6665 6174 7572  (combo) + featur
-00000980: 6573 5d2c 2059 2920 2023 2053 746f 7265  es], Y)  # Store
-00000990: 2074 656d 7020 7265 7375 6c74 0d0a 0d0a   temp result....
-000009a0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-000009b0: 6d70 5f72 6573 756c 745b 305d 203c 2062  mp_result[0] < b
-000009c0: 6573 745f 5353 453a 0d0a 2020 2020 2020  est_SSE:..      
-000009d0: 2020 2020 2020 2020 2020 6265 7374 5f53            best_S
-000009e0: 5345 203d 2074 6d70 5f72 6573 756c 745b  SE = tmp_result[
-000009f0: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-00000a00: 2020 2020 6265 7374 5f52 5f73 7175 6172      best_R_squar
-00000a10: 6564 203d 2074 6d70 5f72 6573 756c 745b  ed = tmp_result[
-00000a20: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-00000a30: 2020 2020 6265 7374 5f61 646a 5f52 3220      best_adj_R2 
-00000a40: 3d20 746d 705f 7265 7375 6c74 5b32 5d0d  = tmp_result[2].
-00000a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000a60: 2062 6573 745f 4149 4320 3d20 746d 705f   best_AIC = tmp_
-00000a70: 7265 7375 6c74 5b33 5d0d 0a20 2020 2020  result[3]..     
-00000a80: 2020 2020 2020 2020 2020 2062 6573 745f             best_
-00000a90: 4249 4320 3d20 746d 705f 7265 7375 6c74  BIC = tmp_result
-00000aa0: 5b34 5d0d 0a20 2020 2020 2020 2020 2020  [4]..           
-00000ab0: 2020 2020 2062 6573 745f 6665 6174 7572       best_featur
-00000ac0: 6520 3d20 636f 6d62 6f5b 305d 0d0a 0d0a  e = combo[0]....
-00000ad0: 2020 2020 2020 2020 2320 5570 6461 7469          # Updati
-00000ae0: 6e67 2076 6172 6961 626c 6573 2066 6f72  ng variables for
-00000af0: 206e 6578 7420 6c6f 6f70 0d0a 2020 2020   next loop..    
-00000b00: 2020 2020 6665 6174 7572 6573 2e61 7070      features.app
-00000b10: 656e 6428 6265 7374 5f66 6561 7475 7265  end(best_feature
-00000b20: 290d 0a20 2020 2020 2020 2072 656d 6169  )..        remai
-00000b30: 6e69 6e67 5f66 6561 7475 7265 732e 7265  ning_features.re
-00000b40: 6d6f 7665 2862 6573 745f 6665 6174 7572  move(best_featur
-00000b50: 6529 0d0a 0d0a 2020 2020 2020 2020 2320  e)....        # 
-00000b60: 5361 7669 6e67 2076 616c 7565 7320 666f  Saving values fo
-00000b70: 7220 706c 6f74 7469 6e67 0d0a 2020 2020  r plotting..    
-00000b80: 2020 2020 5353 455f 6c69 7374 2e61 7070      SSE_list.app
-00000b90: 656e 6428 6265 7374 5f53 5345 290d 0a20  end(best_SSE).. 
-00000ba0: 2020 2020 2020 2052 5f73 7175 6172 6564         R_squared
-00000bb0: 5f6c 6973 742e 6170 7065 6e64 2862 6573  _list.append(bes
-00000bc0: 745f 525f 7371 7561 7265 6429 0d0a 2020  t_R_squared)..  
-00000bd0: 2020 2020 2020 6164 6a5f 5232 5f6c 6973        adj_R2_lis
-00000be0: 742e 6170 7065 6e64 2862 6573 745f 6164  t.append(best_ad
-00000bf0: 6a5f 5232 290d 0a20 2020 2020 2020 2041  j_R2)..        A
-00000c00: 4943 5f6c 6973 742e 6170 7065 6e64 2862  IC_list.append(b
-00000c10: 6573 745f 4149 4329 0d0a 2020 2020 2020  est_AIC)..      
-00000c20: 2020 4249 435f 6c69 7374 2e61 7070 656e    BIC_list.appen
-00000c30: 6428 6265 7374 5f42 4943 290d 0a20 2020  d(best_BIC)..   
-00000c40: 2020 2020 2066 6561 7475 7265 735f 6c69       features_li
-00000c50: 7374 5b69 5d20 3d20 6665 6174 7572 6573  st[i] = features
-00000c60: 2e63 6f70 7928 290d 0a0d 0a20 2020 2072  .copy()....    r
-00000c70: 6573 756c 7420 3d20 7b27 5353 4527 3a20  esult = {'SSE': 
-00000c80: 5353 455f 6c69 7374 2c0d 0a20 2020 2020  SSE_list,..     
-00000c90: 2020 2020 2020 2020 2027 525f 7371 7561           'R_squa
-00000ca0: 7265 6427 3a20 525f 7371 7561 7265 645f  red': R_squared_
-00000cb0: 6c69 7374 2c0d 0a20 2020 2020 2020 2020  list,..         
-00000cc0: 2020 2020 2027 6164 6a5f 5232 273a 2061       'adj_R2': a
-00000cd0: 646a 5f52 325f 6c69 7374 2c0d 0a20 2020  dj_R2_list,..   
-00000ce0: 2020 2020 2020 2020 2020 2027 4149 4327             'AIC'
-00000cf0: 3a20 4149 435f 6c69 7374 2c0d 0a20 2020  : AIC_list,..   
-00000d00: 2020 2020 2020 2020 2020 2027 4249 4327             'BIC'
-00000d10: 3a20 4249 435f 6c69 7374 2c0d 0a20 2020  : BIC_list,..   
-00000d20: 2020 2020 2020 2020 2020 2027 6665 6174             'feat
-00000d30: 7572 6573 273a 2066 6561 7475 7265 735f  ures': features_
-00000d40: 6c69 7374 7d0d 0a0d 0a20 2020 2072 6574  list}....    ret
-00000d50: 7572 6e20 7265 7375 6c74 0d0a 0d0a 6465  urn result....de
-00000d60: 6620 6261 636b 7761 7264 5f73 656c 6563  f backward_selec
-00000d70: 7469 6f6e 2858 2c20 5929 3a0d 0a20 2020  tion(X, Y):..   
-00000d80: 206b 203d 2058 2e73 6861 7065 5b31 5d0d   k = X.shape[1].
-00000d90: 0a0d 0a20 2020 2072 656d 6169 6e69 6e67  ...    remaining
-00000da0: 5f66 6561 7475 7265 7320 3d20 6c69 7374  _features = list
-00000db0: 2858 2e63 6f6c 756d 6e73 2e76 616c 7565  (X.columns.value
-00000dc0: 7329 0d0a 2020 2020 5353 455f 6c69 7374  s)..    SSE_list
-00000dd0: 2c20 525f 7371 7561 7265 645f 6c69 7374  , R_squared_list
-00000de0: 2c20 6164 6a5f 5232 5f6c 6973 742c 2041  , adj_R2_list, A
-00000df0: 4943 5f6c 6973 742c 2042 4943 5f6c 6973  IC_list, BIC_lis
-00000e00: 7420 3d20 5b5d 2c20 5b5d 2c20 5b5d 2c20  t = [], [], [], 
-00000e10: 5b5d 2c20 5b5d 2020 2320 4475 6520 746f  [], []  # Due to
-00000e20: 2031 2069 6e64 6578 696e 6720 6f66 2074   1 indexing of t
-00000e30: 6865 206c 6f6f 702e 2e2e 0d0a 0d0a 2020  he loop.......  
-00000e40: 2020 6665 6174 7572 6573 5f6c 6973 7420    features_list 
-00000e50: 3d20 6469 6374 2829 0d0a 0d0a 2020 2020  = dict()....    
-00000e60: 666f 7220 6920 696e 2072 616e 6765 2831  for i in range(1
-00000e70: 2c20 6b20 2b20 3129 3a0d 0a20 2020 2020  , k + 1):..     
-00000e80: 2020 2062 6573 745f 5353 4520 3d20 6e70     best_SSE = np
-00000e90: 2e69 6e66 0d0a 0d0a 2020 2020 2020 2020  .inf....        
-00000ea0: 666f 7220 636f 6d62 6f20 696e 2069 7465  for combo in ite
-00000eb0: 7274 6f6f 6c73 2e63 6f6d 6269 6e61 7469  rtools.combinati
-00000ec0: 6f6e 7328 7265 6d61 696e 696e 675f 6665  ons(remaining_fe
-00000ed0: 6174 7572 6573 2c20 6b20 2b20 3120 2d20  atures, k + 1 - 
-00000ee0: 6929 3a0d 0a0d 0a20 2020 2020 2020 2020  i):....         
-00000ef0: 2020 2074 656d 705f 7265 7375 6c74 203d     temp_result =
-00000f00: 2066 6974 5f6c 696e 6561 725f 7265 6728   fit_linear_reg(
-00000f10: 585b 6c69 7374 2863 6f6d 626f 295d 2c20  X[list(combo)], 
-00000f20: 5929 2020 2320 5374 6f72 6520 7465 6d70  Y)  # Store temp
-00000f30: 2072 6573 756c 740d 0a0d 0a20 2020 2020   result....     
-00000f40: 2020 2020 2020 2069 6620 7465 6d70 5f72         if temp_r
-00000f50: 6573 756c 745b 305d 203c 2062 6573 745f  esult[0] < best_
-00000f60: 5353 453a 0d0a 2020 2020 2020 2020 2020  SSE:..          
-00000f70: 2020 2020 2020 6265 7374 5f53 5345 203d        best_SSE =
-00000f80: 2074 656d 705f 7265 7375 6c74 5b30 5d0d   temp_result[0].
-00000f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000fa0: 2062 6573 745f 525f 7371 7561 7265 6420   best_R_squared 
-00000fb0: 3d20 7465 6d70 5f72 6573 756c 745b 315d  = temp_result[1]
-00000fc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000fd0: 2020 6265 7374 5f61 646a 5f52 3220 3d20    best_adj_R2 = 
-00000fe0: 7465 6d70 5f72 6573 756c 745b 325d 0d0a  temp_result[2]..
-00000ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001000: 6265 7374 5f41 4943 203d 2074 656d 705f  best_AIC = temp_
-00001010: 7265 7375 6c74 5b33 5d0d 0a20 2020 2020  result[3]..     
-00001020: 2020 2020 2020 2020 2020 2062 6573 745f             best_
-00001030: 4249 4320 3d20 7465 6d70 5f72 6573 756c  BIC = temp_resul
-00001040: 745b 345d 0d0a 2020 2020 2020 2020 2020  t[4]..          
-00001050: 2020 2020 2020 6265 7374 5f66 6561 7475        best_featu
-00001060: 7265 203d 2063 6f6d 626f 0d0a 0d0a 2020  re = combo....  
-00001070: 2020 2020 2020 2320 5570 6461 7469 6e67        # Updating
-00001080: 2076 6172 6961 626c 6573 2066 6f72 206e   variables for n
-00001090: 6578 7420 6c6f 6f70 0d0a 2020 2020 2020  ext loop..      
-000010a0: 2020 7265 6d61 696e 696e 675f 6665 6174    remaining_feat
-000010b0: 7572 6573 203d 2062 6573 745f 6665 6174  ures = best_feat
-000010c0: 7572 650d 0a0d 0a20 2020 2020 2020 2023  ure....        #
-000010d0: 2053 6176 696e 6720 7661 6c75 6573 2066   Saving values f
-000010e0: 6f72 2070 6c6f 7474 696e 670d 0a20 2020  or plotting..   
-000010f0: 2020 2020 2053 5345 5f6c 6973 742e 6170       SSE_list.ap
-00001100: 7065 6e64 2862 6573 745f 5353 4529 0d0a  pend(best_SSE)..
-00001110: 2020 2020 2020 2020 525f 7371 7561 7265          R_square
-00001120: 645f 6c69 7374 2e61 7070 656e 6428 6265  d_list.append(be
-00001130: 7374 5f52 5f73 7175 6172 6564 290d 0a20  st_R_squared).. 
-00001140: 2020 2020 2020 2061 646a 5f52 325f 6c69         adj_R2_li
-00001150: 7374 2e61 7070 656e 6428 6265 7374 5f61  st.append(best_a
-00001160: 646a 5f52 3229 0d0a 2020 2020 2020 2020  dj_R2)..        
-00001170: 4149 435f 6c69 7374 2e61 7070 656e 6428  AIC_list.append(
-00001180: 6265 7374 5f41 4943 290d 0a20 2020 2020  best_AIC)..     
-00001190: 2020 2042 4943 5f6c 6973 742e 6170 7065     BIC_list.appe
-000011a0: 6e64 2862 6573 745f 4249 4329 0d0a 2020  nd(best_BIC)..  
-000011b0: 2020 2020 2020 6665 6174 7572 6573 5f6c        features_l
-000011c0: 6973 745b 695d 203d 2062 6573 745f 6665  ist[i] = best_fe
-000011d0: 6174 7572 650d 0a0d 0a20 2020 2072 6573  ature....    res
-000011e0: 756c 7420 3d20 7b27 5353 4527 3a20 5353  ult = {'SSE': SS
-000011f0: 455f 6c69 7374 2c0d 0a20 2020 2020 2020  E_list,..       
-00001200: 2020 2020 2020 2027 525f 7371 7561 7265         'R_square
-00001210: 6427 3a20 525f 7371 7561 7265 645f 6c69  d': R_squared_li
-00001220: 7374 2c0d 0a20 2020 2020 2020 2020 2020  st,..           
-00001230: 2020 2027 6164 6a5f 5232 273a 2061 646a     'adj_R2': adj
-00001240: 5f52 325f 6c69 7374 2c0d 0a20 2020 2020  _R2_list,..     
-00001250: 2020 2020 2020 2020 2027 4149 4327 3a20           'AIC': 
-00001260: 4149 435f 6c69 7374 2c0d 0a20 2020 2020  AIC_list,..     
-00001270: 2020 2020 2020 2020 2027 4249 4327 3a20           'BIC': 
-00001280: 4249 435f 6c69 7374 2c0d 0a20 2020 2020  BIC_list,..     
-00001290: 2020 2020 2020 2020 2027 6665 6174 7572           'featur
-000012a0: 6573 273a 2066 6561 7475 7265 735f 6c69  es': features_li
-000012b0: 7374 7d0d 0a0d 0a20 2020 2072 6574 7572  st}....    retur
-000012c0: 6e20 7265 7375 6c74 0d0a 0d0a 6465 6620  n result....def 
-000012d0: 7374 6570 7769 7365 5f73 656c 6563 7469  stepwise_selecti
-000012e0: 6f6e 2858 2c20 792c 0d0a 2020 2020 2020  on(X, y,..      
-000012f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001300: 2069 6e69 7469 616c 5f6c 6973 743d 5b5d   initial_list=[]
-00001310: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00001320: 2020 2020 2020 2020 2020 7468 7265 7368            thresh
-00001330: 6f6c 645f 696e 3d30 2e30 312c 0d0a 2020  old_in=0.01,..  
-00001340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001350: 2020 2020 2074 6872 6573 686f 6c64 5f6f       threshold_o
-00001360: 7574 203d 2030 2e30 352c 0d0a 2020 2020  ut = 0.05,..    
+00000270: 290d 0a20 2020 2052 4d53 453d 6e70 2e73  )..    RMSE=np.s
+00000280: 7172 7428 5353 452f 6c65 6e28 5829 2d31  qrt(SSE/len(X)-1
+00000290: 2d58 2e73 6861 7065 5b31 5d29 0d0a 2020  -X.shape[1])..  
+000002a0: 2020 525f 7371 7561 7265 6420 3d20 6d6f    R_squared = mo
+000002b0: 6465 6c5f 6b2e 7273 7175 6172 6564 0d0a  del_k.rsquared..
+000002c0: 2020 2020 6164 6a5f 5232 203d 206d 6f64      adj_R2 = mod
+000002d0: 656c 5f6b 2e72 7371 7561 7265 645f 6164  el_k.rsquared_ad
+000002e0: 6a0d 0a20 2020 2041 4943 203d 206d 6f64  j..    AIC = mod
+000002f0: 656c 5f6b 2e61 6963 0d0a 2020 2020 4249  el_k.aic..    BI
+00000300: 4320 3d20 6d6f 6465 6c5f 6b2e 6269 630d  C = model_k.bic.
+00000310: 0a20 2020 2072 6574 7572 6e20 524d 5345  .    return RMSE
+00000320: 2c20 525f 7371 7561 7265 642c 2061 646a  , R_squared, adj
+00000330: 5f52 322c 2041 4943 2c20 4249 430d 0a0d  _R2, AIC, BIC...
+00000340: 0a64 6566 2062 6573 745f 7375 6273 6574  .def best_subset
+00000350: 5f73 656c 6563 7469 6f6e 2858 2c20 5929  _selection(X, Y)
+00000360: 3a0d 0a20 2020 206b 203d 2058 2e73 6861  :..    k = X.sha
+00000370: 7065 5b31 5d0d 0a20 2020 2052 4d53 455f  pe[1]..    RMSE_
+00000380: 6c69 7374 2c20 525f 7371 7561 7265 645f  list, R_squared_
+00000390: 6c69 7374 2c20 6164 6a5f 5232 5f6c 6973  list, adj_R2_lis
+000003a0: 742c 2041 4943 5f6c 6973 742c 2042 4943  t, AIC_list, BIC
+000003b0: 5f6c 6973 742c 2066 6561 7475 7265 5f6c  _list, feature_l
+000003c0: 6973 7420 3d20 5b5d 2c20 5b5d 2c20 5b5d  ist = [], [], []
+000003d0: 2c20 5b5d 2c20 5b5d 2c20 5b5d 0d0a 2020  , [], [], []..  
+000003e0: 2020 6e75 6d62 5f66 6561 7475 7265 7320    numb_features 
+000003f0: 3d20 5b5d 0d0a 0d0a 2020 2020 2320 4c6f  = []....    # Lo
+00000400: 6f70 696e 6720 6f76 6572 206b 203d 2031  oping over k = 1
+00000410: 2074 6f20 6b20 3d20 3131 2066 6561 7475   to k = 11 featu
+00000420: 7265 7320 696e 2058 0d0a 2020 2020 666f  res in X..    fo
+00000430: 7220 6b20 696e 206e 6f74 6562 6f6f 6b2e  r k in notebook.
+00000440: 7472 616e 6765 2831 2c20 6c65 6e28 582e  trange(1, len(X.
+00000450: 636f 6c75 6d6e 7329 202b 2031 2c20 6465  columns) + 1, de
+00000460: 7363 3d27 4c6f 6f70 2e2e 2e27 293a 0d0a  sc='Loop...'):..
+00000470: 0d0a 2020 2020 2020 2020 2320 4c6f 6f70  ..        # Loop
+00000480: 696e 6720 6f76 6572 2061 6c6c 2070 6f73  ing over all pos
+00000490: 7369 626c 6520 636f 6d62 696e 6174 696f  sible combinatio
+000004a0: 6e73 3a20 6672 6f6d 2031 3120 6368 6f6f  ns: from 11 choo
+000004b0: 7365 206b 0d0a 2020 2020 2020 2020 666f  se k..        fo
+000004c0: 7220 636f 6d62 6f20 696e 2069 7465 7274  r combo in itert
+000004d0: 6f6f 6c73 2e63 6f6d 6269 6e61 7469 6f6e  ools.combination
+000004e0: 7328 582e 636f 6c75 6d6e 732c 206b 293a  s(X.columns, k):
+000004f0: 0d0a 2020 2020 2020 2020 2020 2020 746d  ..            tm
+00000500: 705f 7265 7375 6c74 203d 2066 6974 5f6c  p_result = fit_l
+00000510: 696e 6561 725f 7265 6728 585b 6c69 7374  inear_reg(X[list
+00000520: 2863 6f6d 626f 295d 2c20 5929 2020 2320  (combo)], Y)  # 
+00000530: 5374 6f72 6520 7465 6d70 2072 6573 756c  Store temp resul
+00000540: 740d 0a20 2020 2020 2020 2020 2020 2052  t..            R
+00000550: 4d53 455f 6c69 7374 2e61 7070 656e 6428  MSE_list.append(
+00000560: 746d 705f 7265 7375 6c74 5b30 5d29 2020  tmp_result[0])  
+00000570: 2320 4164 6473 2069 7473 2061 7267 756d  # Adds its argum
+00000580: 656e 7420 6173 2061 2073 696e 676c 6520  ent as a single 
+00000590: 656c 656d 656e 7420 746f 2074 6865 2065  element to the e
+000005a0: 6e64 206f 6620 6120 6c69 7374 2e0d 0a20  nd of a list... 
+000005b0: 2020 2020 2020 2020 2020 2052 5f73 7175             R_squ
+000005c0: 6172 6564 5f6c 6973 742e 6170 7065 6e64  ared_list.append
+000005d0: 2874 6d70 5f72 6573 756c 745b 315d 290d  (tmp_result[1]).
+000005e0: 0a20 2020 2020 2020 2020 2020 2061 646a  .            adj
+000005f0: 5f52 325f 6c69 7374 2e61 7070 656e 6428  _R2_list.append(
+00000600: 746d 705f 7265 7375 6c74 5b32 5d29 0d0a  tmp_result[2])..
+00000610: 2020 2020 2020 2020 2020 2020 4149 435f              AIC_
+00000620: 6c69 7374 2e61 7070 656e 6428 746d 705f  list.append(tmp_
+00000630: 7265 7375 6c74 5b33 5d29 0d0a 2020 2020  result[3])..    
+00000640: 2020 2020 2020 2020 4249 435f 6c69 7374          BIC_list
+00000650: 2e61 7070 656e 6428 746d 705f 7265 7375  .append(tmp_resu
+00000660: 6c74 5b34 5d29 0d0a 2020 2020 2020 2020  lt[4])..        
+00000670: 2020 2020 6665 6174 7572 655f 6c69 7374      feature_list
+00000680: 2e61 7070 656e 6428 636f 6d62 6f29 0d0a  .append(combo)..
+00000690: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+000006a0: 5f66 6561 7475 7265 732e 6170 7065 6e64  _features.append
+000006b0: 286c 656e 2863 6f6d 626f 2929 0d0a 0d0a  (len(combo))....
+000006c0: 2020 2020 2020 2020 2020 2020 2320 5374              # St
+000006d0: 6f72 6520 696e 2044 6174 6146 7261 6d65  ore in DataFrame
+000006e0: 0d0a 2020 2020 6466 203d 2070 642e 4461  ..    df = pd.Da
+000006f0: 7461 4672 616d 6528 0d0a 2020 2020 2020  taFrame(..      
+00000700: 2020 7b27 6e75 6d62 5f66 6561 7475 7265    {'numb_feature
+00000710: 7327 3a20 6e75 6d62 5f66 6561 7475 7265  s': numb_feature
+00000720: 732c 2027 524d 5345 273a 2052 4d53 455f  s, 'RMSE': RMSE_
+00000730: 6c69 7374 2c20 2752 5f73 7175 6172 6564  list, 'R_squared
+00000740: 273a 2052 5f73 7175 6172 6564 5f6c 6973  ': R_squared_lis
+00000750: 742c 2027 6164 6a5f 5232 273a 2061 646a  t, 'adj_R2': adj
+00000760: 5f52 325f 6c69 7374 2c0d 0a20 2020 2020  _R2_list,..     
+00000770: 2020 2020 2741 4943 273a 2041 4943 5f6c      'AIC': AIC_l
+00000780: 6973 742c 2027 4249 4327 3a20 4249 435f  ist, 'BIC': BIC_
+00000790: 6c69 7374 2c20 2766 6561 7475 7265 7327  list, 'features'
+000007a0: 3a20 6665 6174 7572 655f 6c69 7374 7d29  : feature_list})
+000007b0: 0d0a 2020 2020 7265 7475 726e 2064 660d  ..    return df.
+000007c0: 0a0d 0a64 6566 2066 6f72 7761 7264 5f73  ...def forward_s
+000007d0: 656c 6563 7469 6f6e 2858 2c20 5929 3a0d  election(X, Y):.
+000007e0: 0a20 2020 206b 203d 2058 2e73 6861 7065  .    k = X.shape
+000007f0: 5b31 5d0d 0a0d 0a20 2020 2072 656d 6169  [1]....    remai
+00000800: 6e69 6e67 5f66 6561 7475 7265 7320 3d20  ning_features = 
+00000810: 6c69 7374 2858 2e63 6f6c 756d 6e73 2e76  list(X.columns.v
+00000820: 616c 7565 7329 0d0a 2020 2020 6665 6174  alues)..    feat
+00000830: 7572 6573 203d 205b 5d0d 0a20 2020 2053  ures = []..    S
+00000840: 5345 5f6c 6973 742c 2052 5f73 7175 6172  SE_list, R_squar
+00000850: 6564 5f6c 6973 742c 2061 646a 5f52 325f  ed_list, adj_R2_
+00000860: 6c69 7374 2c20 4149 435f 6c69 7374 2c20  list, AIC_list, 
+00000870: 4249 435f 6c69 7374 203d 205b 6e70 2e69  BIC_list = [np.i
+00000880: 6e66 5d2c 205b 6e70 2e69 6e66 5d2c 205b  nf], [np.inf], [
+00000890: 6e70 2e69 6e66 5d2c 205b 6e70 2e69 6e66  np.inf], [np.inf
+000008a0: 5d2c 205b 6e70 2e69 6e66 5d20 2023 2044  ], [np.inf]  # D
+000008b0: 7565 2074 6f20 3120 696e 6465 7869 6e67  ue to 1 indexing
+000008c0: 206f 6620 7468 6520 6c6f 6f70 2e2e 2e0d   of the loop....
+000008d0: 0a20 2020 2066 6561 7475 7265 735f 6c69  .    features_li
+000008e0: 7374 203d 2064 6963 7428 290d 0a0d 0a20  st = dict().... 
+000008f0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00000900: 6528 312c 206b 202b 2031 293a 0d0a 2020  e(1, k + 1):..  
+00000910: 2020 2020 2020 6265 7374 5f53 5345 203d        best_SSE =
+00000920: 206e 702e 696e 660d 0a0d 0a20 2020 2020   np.inf....     
+00000930: 2020 2066 6f72 2063 6f6d 626f 2069 6e20     for combo in 
+00000940: 6974 6572 746f 6f6c 732e 636f 6d62 696e  itertools.combin
+00000950: 6174 696f 6e73 2872 656d 6169 6e69 6e67  ations(remaining
+00000960: 5f66 6561 7475 7265 732c 2031 293a 0d0a  _features, 1):..
+00000970: 0d0a 2020 2020 2020 2020 2020 2020 746d  ..            tm
+00000980: 705f 7265 7375 6c74 203d 2066 6974 5f6c  p_result = fit_l
+00000990: 696e 6561 725f 7265 6728 585b 6c69 7374  inear_reg(X[list
+000009a0: 2863 6f6d 626f 2920 2b20 6665 6174 7572  (combo) + featur
+000009b0: 6573 5d2c 2059 2920 2023 2053 746f 7265  es], Y)  # Store
+000009c0: 2074 656d 7020 7265 7375 6c74 0d0a 0d0a   temp result....
+000009d0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+000009e0: 6d70 5f72 6573 756c 745b 305d 203c 2062  mp_result[0] < b
+000009f0: 6573 745f 5353 453a 0d0a 2020 2020 2020  est_SSE:..      
+00000a00: 2020 2020 2020 2020 2020 6265 7374 5f53            best_S
+00000a10: 5345 203d 2074 6d70 5f72 6573 756c 745b  SE = tmp_result[
+00000a20: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+00000a30: 2020 2020 6265 7374 5f52 5f73 7175 6172      best_R_squar
+00000a40: 6564 203d 2074 6d70 5f72 6573 756c 745b  ed = tmp_result[
+00000a50: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
+00000a60: 2020 2020 6265 7374 5f61 646a 5f52 3220      best_adj_R2 
+00000a70: 3d20 746d 705f 7265 7375 6c74 5b32 5d0d  = tmp_result[2].
+00000a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000a90: 2062 6573 745f 4149 4320 3d20 746d 705f   best_AIC = tmp_
+00000aa0: 7265 7375 6c74 5b33 5d0d 0a20 2020 2020  result[3]..     
+00000ab0: 2020 2020 2020 2020 2020 2062 6573 745f             best_
+00000ac0: 4249 4320 3d20 746d 705f 7265 7375 6c74  BIC = tmp_result
+00000ad0: 5b34 5d0d 0a20 2020 2020 2020 2020 2020  [4]..           
+00000ae0: 2020 2020 2062 6573 745f 6665 6174 7572       best_featur
+00000af0: 6520 3d20 636f 6d62 6f5b 305d 0d0a 0d0a  e = combo[0]....
+00000b00: 2020 2020 2020 2020 2320 5570 6461 7469          # Updati
+00000b10: 6e67 2076 6172 6961 626c 6573 2066 6f72  ng variables for
+00000b20: 206e 6578 7420 6c6f 6f70 0d0a 2020 2020   next loop..    
+00000b30: 2020 2020 6665 6174 7572 6573 2e61 7070      features.app
+00000b40: 656e 6428 6265 7374 5f66 6561 7475 7265  end(best_feature
+00000b50: 290d 0a20 2020 2020 2020 2072 656d 6169  )..        remai
+00000b60: 6e69 6e67 5f66 6561 7475 7265 732e 7265  ning_features.re
+00000b70: 6d6f 7665 2862 6573 745f 6665 6174 7572  move(best_featur
+00000b80: 6529 0d0a 0d0a 2020 2020 2020 2020 2320  e)....        # 
+00000b90: 5361 7669 6e67 2076 616c 7565 7320 666f  Saving values fo
+00000ba0: 7220 706c 6f74 7469 6e67 0d0a 2020 2020  r plotting..    
+00000bb0: 2020 2020 5353 455f 6c69 7374 2e61 7070      SSE_list.app
+00000bc0: 656e 6428 6265 7374 5f53 5345 290d 0a20  end(best_SSE).. 
+00000bd0: 2020 2020 2020 2052 5f73 7175 6172 6564         R_squared
+00000be0: 5f6c 6973 742e 6170 7065 6e64 2862 6573  _list.append(bes
+00000bf0: 745f 525f 7371 7561 7265 6429 0d0a 2020  t_R_squared)..  
+00000c00: 2020 2020 2020 6164 6a5f 5232 5f6c 6973        adj_R2_lis
+00000c10: 742e 6170 7065 6e64 2862 6573 745f 6164  t.append(best_ad
+00000c20: 6a5f 5232 290d 0a20 2020 2020 2020 2041  j_R2)..        A
+00000c30: 4943 5f6c 6973 742e 6170 7065 6e64 2862  IC_list.append(b
+00000c40: 6573 745f 4149 4329 0d0a 2020 2020 2020  est_AIC)..      
+00000c50: 2020 4249 435f 6c69 7374 2e61 7070 656e    BIC_list.appen
+00000c60: 6428 6265 7374 5f42 4943 290d 0a20 2020  d(best_BIC)..   
+00000c70: 2020 2020 2066 6561 7475 7265 735f 6c69       features_li
+00000c80: 7374 5b69 5d20 3d20 6665 6174 7572 6573  st[i] = features
+00000c90: 2e63 6f70 7928 290d 0a0d 0a20 2020 2072  .copy()....    r
+00000ca0: 6573 756c 7420 3d20 7b27 5353 4527 3a20  esult = {'SSE': 
+00000cb0: 5353 455f 6c69 7374 2c0d 0a20 2020 2020  SSE_list,..     
+00000cc0: 2020 2020 2020 2020 2027 525f 7371 7561           'R_squa
+00000cd0: 7265 6427 3a20 525f 7371 7561 7265 645f  red': R_squared_
+00000ce0: 6c69 7374 2c0d 0a20 2020 2020 2020 2020  list,..         
+00000cf0: 2020 2020 2027 6164 6a5f 5232 273a 2061       'adj_R2': a
+00000d00: 646a 5f52 325f 6c69 7374 2c0d 0a20 2020  dj_R2_list,..   
+00000d10: 2020 2020 2020 2020 2020 2027 4149 4327             'AIC'
+00000d20: 3a20 4149 435f 6c69 7374 2c0d 0a20 2020  : AIC_list,..   
+00000d30: 2020 2020 2020 2020 2020 2027 4249 4327             'BIC'
+00000d40: 3a20 4249 435f 6c69 7374 2c0d 0a20 2020  : BIC_list,..   
+00000d50: 2020 2020 2020 2020 2020 2027 6665 6174             'feat
+00000d60: 7572 6573 273a 2066 6561 7475 7265 735f  ures': features_
+00000d70: 6c69 7374 7d0d 0a0d 0a20 2020 2072 6574  list}....    ret
+00000d80: 7572 6e20 7265 7375 6c74 0d0a 0d0a 6465  urn result....de
+00000d90: 6620 6261 636b 7761 7264 5f73 656c 6563  f backward_selec
+00000da0: 7469 6f6e 2858 2c20 5929 3a0d 0a20 2020  tion(X, Y):..   
+00000db0: 206b 203d 2058 2e73 6861 7065 5b31 5d0d   k = X.shape[1].
+00000dc0: 0a0d 0a20 2020 2072 656d 6169 6e69 6e67  ...    remaining
+00000dd0: 5f66 6561 7475 7265 7320 3d20 6c69 7374  _features = list
+00000de0: 2858 2e63 6f6c 756d 6e73 2e76 616c 7565  (X.columns.value
+00000df0: 7329 0d0a 2020 2020 5353 455f 6c69 7374  s)..    SSE_list
+00000e00: 2c20 525f 7371 7561 7265 645f 6c69 7374  , R_squared_list
+00000e10: 2c20 6164 6a5f 5232 5f6c 6973 742c 2041  , adj_R2_list, A
+00000e20: 4943 5f6c 6973 742c 2042 4943 5f6c 6973  IC_list, BIC_lis
+00000e30: 7420 3d20 5b5d 2c20 5b5d 2c20 5b5d 2c20  t = [], [], [], 
+00000e40: 5b5d 2c20 5b5d 2020 2320 4475 6520 746f  [], []  # Due to
+00000e50: 2031 2069 6e64 6578 696e 6720 6f66 2074   1 indexing of t
+00000e60: 6865 206c 6f6f 702e 2e2e 0d0a 0d0a 2020  he loop.......  
+00000e70: 2020 6665 6174 7572 6573 5f6c 6973 7420    features_list 
+00000e80: 3d20 6469 6374 2829 0d0a 0d0a 2020 2020  = dict()....    
+00000e90: 666f 7220 6920 696e 2072 616e 6765 2831  for i in range(1
+00000ea0: 2c20 6b20 2b20 3129 3a0d 0a20 2020 2020  , k + 1):..     
+00000eb0: 2020 2062 6573 745f 5353 4520 3d20 6e70     best_SSE = np
+00000ec0: 2e69 6e66 0d0a 0d0a 2020 2020 2020 2020  .inf....        
+00000ed0: 666f 7220 636f 6d62 6f20 696e 2069 7465  for combo in ite
+00000ee0: 7274 6f6f 6c73 2e63 6f6d 6269 6e61 7469  rtools.combinati
+00000ef0: 6f6e 7328 7265 6d61 696e 696e 675f 6665  ons(remaining_fe
+00000f00: 6174 7572 6573 2c20 6b20 2b20 3120 2d20  atures, k + 1 - 
+00000f10: 6929 3a0d 0a0d 0a20 2020 2020 2020 2020  i):....         
+00000f20: 2020 2074 656d 705f 7265 7375 6c74 203d     temp_result =
+00000f30: 2066 6974 5f6c 696e 6561 725f 7265 6728   fit_linear_reg(
+00000f40: 585b 6c69 7374 2863 6f6d 626f 295d 2c20  X[list(combo)], 
+00000f50: 5929 2020 2320 5374 6f72 6520 7465 6d70  Y)  # Store temp
+00000f60: 2072 6573 756c 740d 0a0d 0a20 2020 2020   result....     
+00000f70: 2020 2020 2020 2069 6620 7465 6d70 5f72         if temp_r
+00000f80: 6573 756c 745b 305d 203c 2062 6573 745f  esult[0] < best_
+00000f90: 5353 453a 0d0a 2020 2020 2020 2020 2020  SSE:..          
+00000fa0: 2020 2020 2020 6265 7374 5f53 5345 203d        best_SSE =
+00000fb0: 2074 656d 705f 7265 7375 6c74 5b30 5d0d   temp_result[0].
+00000fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000fd0: 2062 6573 745f 525f 7371 7561 7265 6420   best_R_squared 
+00000fe0: 3d20 7465 6d70 5f72 6573 756c 745b 315d  = temp_result[1]
+00000ff0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001000: 2020 6265 7374 5f61 646a 5f52 3220 3d20    best_adj_R2 = 
+00001010: 7465 6d70 5f72 6573 756c 745b 325d 0d0a  temp_result[2]..
+00001020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001030: 6265 7374 5f41 4943 203d 2074 656d 705f  best_AIC = temp_
+00001040: 7265 7375 6c74 5b33 5d0d 0a20 2020 2020  result[3]..     
+00001050: 2020 2020 2020 2020 2020 2062 6573 745f             best_
+00001060: 4249 4320 3d20 7465 6d70 5f72 6573 756c  BIC = temp_resul
+00001070: 745b 345d 0d0a 2020 2020 2020 2020 2020  t[4]..          
+00001080: 2020 2020 2020 6265 7374 5f66 6561 7475        best_featu
+00001090: 7265 203d 2063 6f6d 626f 0d0a 0d0a 2020  re = combo....  
+000010a0: 2020 2020 2020 2320 5570 6461 7469 6e67        # Updating
+000010b0: 2076 6172 6961 626c 6573 2066 6f72 206e   variables for n
+000010c0: 6578 7420 6c6f 6f70 0d0a 2020 2020 2020  ext loop..      
+000010d0: 2020 7265 6d61 696e 696e 675f 6665 6174    remaining_feat
+000010e0: 7572 6573 203d 2062 6573 745f 6665 6174  ures = best_feat
+000010f0: 7572 650d 0a0d 0a20 2020 2020 2020 2023  ure....        #
+00001100: 2053 6176 696e 6720 7661 6c75 6573 2066   Saving values f
+00001110: 6f72 2070 6c6f 7474 696e 670d 0a20 2020  or plotting..   
+00001120: 2020 2020 2053 5345 5f6c 6973 742e 6170       SSE_list.ap
+00001130: 7065 6e64 2862 6573 745f 5353 4529 0d0a  pend(best_SSE)..
+00001140: 2020 2020 2020 2020 525f 7371 7561 7265          R_square
+00001150: 645f 6c69 7374 2e61 7070 656e 6428 6265  d_list.append(be
+00001160: 7374 5f52 5f73 7175 6172 6564 290d 0a20  st_R_squared).. 
+00001170: 2020 2020 2020 2061 646a 5f52 325f 6c69         adj_R2_li
+00001180: 7374 2e61 7070 656e 6428 6265 7374 5f61  st.append(best_a
+00001190: 646a 5f52 3229 0d0a 2020 2020 2020 2020  dj_R2)..        
+000011a0: 4149 435f 6c69 7374 2e61 7070 656e 6428  AIC_list.append(
+000011b0: 6265 7374 5f41 4943 290d 0a20 2020 2020  best_AIC)..     
+000011c0: 2020 2042 4943 5f6c 6973 742e 6170 7065     BIC_list.appe
+000011d0: 6e64 2862 6573 745f 4249 4329 0d0a 2020  nd(best_BIC)..  
+000011e0: 2020 2020 2020 6665 6174 7572 6573 5f6c        features_l
+000011f0: 6973 745b 695d 203d 2062 6573 745f 6665  ist[i] = best_fe
+00001200: 6174 7572 650d 0a0d 0a20 2020 2072 6573  ature....    res
+00001210: 756c 7420 3d20 7b27 5353 4527 3a20 5353  ult = {'SSE': SS
+00001220: 455f 6c69 7374 2c0d 0a20 2020 2020 2020  E_list,..       
+00001230: 2020 2020 2020 2027 525f 7371 7561 7265         'R_square
+00001240: 6427 3a20 525f 7371 7561 7265 645f 6c69  d': R_squared_li
+00001250: 7374 2c0d 0a20 2020 2020 2020 2020 2020  st,..           
+00001260: 2020 2027 6164 6a5f 5232 273a 2061 646a     'adj_R2': adj
+00001270: 5f52 325f 6c69 7374 2c0d 0a20 2020 2020  _R2_list,..     
+00001280: 2020 2020 2020 2020 2027 4149 4327 3a20           'AIC': 
+00001290: 4149 435f 6c69 7374 2c0d 0a20 2020 2020  AIC_list,..     
+000012a0: 2020 2020 2020 2020 2027 4249 4327 3a20           'BIC': 
+000012b0: 4249 435f 6c69 7374 2c0d 0a20 2020 2020  BIC_list,..     
+000012c0: 2020 2020 2020 2020 2027 6665 6174 7572           'featur
+000012d0: 6573 273a 2066 6561 7475 7265 735f 6c69  es': features_li
+000012e0: 7374 7d0d 0a0d 0a20 2020 2072 6574 7572  st}....    retur
+000012f0: 6e20 7265 7375 6c74 0d0a 0d0a 6465 6620  n result....def 
+00001300: 7374 6570 7769 7365 5f73 656c 6563 7469  stepwise_selecti
+00001310: 6f6e 2858 2c20 792c 0d0a 2020 2020 2020  on(X, y,..      
+00001320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001330: 2069 6e69 7469 616c 5f6c 6973 743d 5b5d   initial_list=[]
+00001340: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00001350: 2020 2020 2020 2020 2020 7468 7265 7368            thresh
+00001360: 6f6c 645f 696e 3d30 2e30 312c 0d0a 2020  old_in=0.01,..  
 00001370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001380: 2020 2076 6572 626f 7365 3d54 7275 6529     verbose=True)
-00001390: 3a0d 0a20 2020 2022 2222 2050 6572 666f  :..    """ Perfo
-000013a0: 726d 2061 2066 6f72 7761 7264 2d62 6163  rm a forward-bac
-000013b0: 6b77 6172 6420 6665 6174 7572 6520 7365  kward feature se
-000013c0: 6c65 6374 696f 6e0d 0a20 2020 2062 6173  lection..    bas
-000013d0: 6564 206f 6e20 702d 7661 6c75 6520 6672  ed on p-value fr
-000013e0: 6f6d 2073 7461 7473 6d6f 6465 6c73 2e61  om statsmodels.a
-000013f0: 7069 2e4f 4c53 0d0a 2020 2020 4172 6775  pi.OLS..    Argu
-00001400: 6d65 6e74 733a 0d0a 2020 2020 2020 2020  ments:..        
-00001410: 5820 2d20 7061 6e64 6173 2e44 6174 6146  X - pandas.DataF
-00001420: 7261 6d65 2077 6974 6820 6361 6e64 6964  rame with candid
-00001430: 6174 6520 6665 6174 7572 6573 0d0a 2020  ate features..  
-00001440: 2020 2020 2020 7920 2d20 6c69 7374 2d6c        y - list-l
-00001450: 696b 6520 7769 7468 2074 6865 2074 6172  ike with the tar
-00001460: 6765 740d 0a20 2020 2020 2020 2069 6e69  get..        ini
-00001470: 7469 616c 5f6c 6973 7420 2d20 6c69 7374  tial_list - list
-00001480: 206f 6620 6665 6174 7572 6573 2074 6f20   of features to 
-00001490: 7374 6172 7420 7769 7468 2028 636f 6c75  start with (colu
-000014a0: 6d6e 206e 616d 6573 206f 6620 5829 0d0a  mn names of X)..
-000014b0: 2020 2020 2020 2020 7468 7265 7368 6f6c          threshol
-000014c0: 645f 696e 202d 2069 6e63 6c75 6465 2061  d_in - include a
-000014d0: 2066 6561 7475 7265 2069 6620 6974 7320   feature if its 
-000014e0: 702d 7661 6c75 6520 3c20 7468 7265 7368  p-value < thresh
-000014f0: 6f6c 645f 696e 0d0a 2020 2020 2020 2020  old_in..        
-00001500: 7468 7265 7368 6f6c 645f 6f75 7420 2d20  threshold_out - 
-00001510: 6578 636c 7564 6520 6120 6665 6174 7572  exclude a featur
-00001520: 6520 6966 2069 7473 2070 2d76 616c 7565  e if its p-value
-00001530: 203e 2074 6872 6573 686f 6c64 5f6f 7574   > threshold_out
-00001540: 0d0a 2020 2020 2020 2020 7665 7262 6f73  ..        verbos
-00001550: 6520 2d20 7768 6574 6865 7220 746f 2070  e - whether to p
-00001560: 7269 6e74 2074 6865 2073 6571 7565 6e63  rint the sequenc
-00001570: 6520 6f66 2069 6e63 6c75 7369 6f6e 7320  e of inclusions 
-00001580: 616e 6420 6578 636c 7573 696f 6e73 0d0a  and exclusions..
-00001590: 2020 2020 5265 7475 726e 733a 206c 6973      Returns: lis
-000015a0: 7420 6f66 2073 656c 6563 7465 6420 6665  t of selected fe
-000015b0: 6174 7572 6573 0d0a 2020 2020 416c 7761  atures..    Alwa
-000015c0: 7973 2073 6574 2074 6872 6573 686f 6c64  ys set threshold
-000015d0: 5f69 6e20 3c20 7468 7265 7368 6f6c 645f  _in < threshold_
-000015e0: 6f75 7420 746f 2061 766f 6964 2069 6e66  out to avoid inf
-000015f0: 696e 6974 6520 6c6f 6f70 696e 672e 0d0a  inite looping...
-00001600: 2020 2020 5365 6520 6874 7470 733a 2f2f      See https://
-00001610: 656e 2e77 696b 6970 6564 6961 2e6f 7267  en.wikipedia.org
-00001620: 2f77 696b 692f 5374 6570 7769 7365 5f72  /wiki/Stepwise_r
-00001630: 6567 7265 7373 696f 6e20 666f 7220 7468  egression for th
-00001640: 6520 6465 7461 696c 730d 0a20 2020 2022  e details..    "
-00001650: 2222 0d0a 2020 2020 696e 636c 7564 6564  ""..    included
-00001660: 203d 206c 6973 7428 696e 6974 6961 6c5f   = list(initial_
-00001670: 6c69 7374 290d 0a20 2020 2077 6869 6c65  list)..    while
-00001680: 2054 7275 653a 0d0a 2020 2020 2020 2020   True:..        
-00001690: 6368 616e 6765 643d 4661 6c73 650d 0a20  changed=False.. 
-000016a0: 2020 2020 2020 2023 2066 6f72 7761 7264         # forward
-000016b0: 2073 7465 700d 0a20 2020 2020 2020 2065   step..        e
-000016c0: 7863 6c75 6465 6420 3d20 6c69 7374 2873  xcluded = list(s
-000016d0: 6574 2858 2e63 6f6c 756d 6e73 292d 7365  et(X.columns)-se
-000016e0: 7428 696e 636c 7564 6564 2929 0d0a 2020  t(included))..  
-000016f0: 2020 2020 2020 6e65 775f 7076 616c 203d        new_pval =
-00001700: 2070 642e 5365 7269 6573 2869 6e64 6578   pd.Series(index
-00001710: 3d65 7863 6c75 6465 6429 0d0a 2020 2020  =excluded)..    
-00001720: 2020 2020 666f 7220 6e65 775f 636f 6c75      for new_colu
-00001730: 6d6e 2069 6e20 6578 636c 7564 6564 3a0d  mn in excluded:.
-00001740: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00001750: 656c 203d 2073 6d2e 4f4c 5328 792c 2073  el = sm.OLS(y, s
-00001760: 6d2e 6164 645f 636f 6e73 7461 6e74 2870  m.add_constant(p
-00001770: 642e 4461 7461 4672 616d 6528 585b 696e  d.DataFrame(X[in
-00001780: 636c 7564 6564 2b5b 6e65 775f 636f 6c75  cluded+[new_colu
-00001790: 6d6e 5d5d 2929 292e 6669 7428 290d 0a20  mn]]))).fit().. 
-000017a0: 2020 2020 2020 2020 2020 206e 6577 5f70             new_p
-000017b0: 7661 6c5b 6e65 775f 636f 6c75 6d6e 5d20  val[new_column] 
-000017c0: 3d20 6d6f 6465 6c2e 7076 616c 7565 735b  = model.pvalues[
-000017d0: 6e65 775f 636f 6c75 6d6e 5d0d 0a20 2020  new_column]..   
-000017e0: 2020 2020 2062 6573 745f 7076 616c 203d       best_pval =
-000017f0: 206e 6577 5f70 7661 6c2e 6d69 6e28 290d   new_pval.min().
-00001800: 0a20 2020 2020 2020 2069 6620 6265 7374  .        if best
-00001810: 5f70 7661 6c20 3c20 7468 7265 7368 6f6c  _pval < threshol
-00001820: 645f 696e 3a0d 0a20 2020 2020 2020 2020  d_in:..         
-00001830: 2020 2062 6573 745f 6665 6174 7572 6520     best_feature 
-00001840: 3d20 6e65 775f 7076 616c 2e69 6478 6d69  = new_pval.idxmi
-00001850: 6e28 290d 0a20 2020 2020 2020 2020 2020  n()..           
-00001860: 2069 6e63 6c75 6465 642e 6170 7065 6e64   included.append
-00001870: 2862 6573 745f 6665 6174 7572 6529 0d0a  (best_feature)..
-00001880: 2020 2020 2020 2020 2020 2020 6368 616e              chan
-00001890: 6765 643d 5472 7565 0d0a 2020 2020 2020  ged=True..      
-000018a0: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
-000018b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000018c0: 2020 2070 7269 6e74 2827 4164 6420 207b     print('Add  {
-000018d0: 3a33 307d 2077 6974 6820 702d 7661 6c75  :30} with p-valu
-000018e0: 6520 7b3a 2e36 7d27 2e66 6f72 6d61 7428  e {:.6}'.format(
-000018f0: 6265 7374 5f66 6561 7475 7265 2c20 6265  best_feature, be
-00001900: 7374 5f70 7661 6c29 290d 0a0d 0a20 2020  st_pval))....   
-00001910: 2020 2020 2023 2062 6163 6b77 6172 6420       # backward 
-00001920: 7374 6570 0d0a 2020 2020 2020 2020 6d6f  step..        mo
-00001930: 6465 6c20 3d20 736d 2e4f 4c53 2879 2c20  del = sm.OLS(y, 
-00001940: 736d 2e61 6464 5f63 6f6e 7374 616e 7428  sm.add_constant(
-00001950: 7064 2e44 6174 6146 7261 6d65 2858 5b69  pd.DataFrame(X[i
-00001960: 6e63 6c75 6465 645d 2929 292e 6669 7428  ncluded]))).fit(
-00001970: 290d 0a20 2020 2020 2020 2023 2075 7365  )..        # use
-00001980: 2061 6c6c 2063 6f65 6673 2065 7863 6570   all coefs excep
-00001990: 7420 696e 7465 7263 6570 740d 0a20 2020  t intercept..   
-000019a0: 2020 2020 2070 7661 6c75 6573 203d 206d       pvalues = m
-000019b0: 6f64 656c 2e70 7661 6c75 6573 2e69 6c6f  odel.pvalues.ilo
-000019c0: 635b 313a 5d0d 0a20 2020 2020 2020 2077  c[1:]..        w
-000019d0: 6f72 7374 5f70 7661 6c20 3d20 7076 616c  orst_pval = pval
-000019e0: 7565 732e 6d61 7828 2920 2320 6e75 6c6c  ues.max() # null
-000019f0: 2069 6620 7076 616c 7565 7320 6973 2065   if pvalues is e
-00001a00: 6d70 7479 0d0a 2020 2020 2020 2020 6966  mpty..        if
-00001a10: 2077 6f72 7374 5f70 7661 6c20 3e20 7468   worst_pval > th
-00001a20: 7265 7368 6f6c 645f 6f75 743a 0d0a 2020  reshold_out:..  
-00001a30: 2020 2020 2020 2020 2020 6368 616e 6765            change
-00001a40: 643d 5472 7565 0d0a 2020 2020 2020 2020  d=True..        
-00001a50: 2020 2020 776f 7273 745f 6665 6174 7572      worst_featur
-00001a60: 6520 3d20 7076 616c 7565 732e 6964 786d  e = pvalues.idxm
-00001a70: 6178 2829 0d0a 2020 2020 2020 2020 2020  ax()..          
-00001a80: 2020 696e 636c 7564 6564 2e72 656d 6f76    included.remov
-00001a90: 6528 776f 7273 745f 6665 6174 7572 6529  e(worst_feature)
-00001aa0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00001ab0: 2076 6572 626f 7365 3a0d 0a20 2020 2020   verbose:..     
-00001ac0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00001ad0: 2827 4472 6f70 207b 3a33 307d 2077 6974  ('Drop {:30} wit
-00001ae0: 6820 702d 7661 6c75 6520 7b3a 2e36 7d27  h p-value {:.6}'
-00001af0: 2e66 6f72 6d61 7428 776f 7273 745f 6665  .format(worst_fe
-00001b00: 6174 7572 652c 2077 6f72 7374 5f70 7661  ature, worst_pva
-00001b10: 6c29 290d 0a20 2020 2020 2020 2069 6620  l))..        if 
-00001b20: 6e6f 7420 6368 616e 6765 643a 0d0a 2020  not changed:..  
-00001b30: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
-00001b40: 0a20 2020 2072 6574 7572 6e20 696e 636c  .    return incl
-00001b50: 7564 6564 0d0a 6465 6620 6f75 746c 6965  uded..def outlie
-00001b60: 7228 6461 7461 6672 616d 652c 6d6f 6465  r(dataframe,mode
-00001b70: 6c2c 5479 7065 3d27 616c 6c27 293a 0d0a  l,Type='all'):..
-00001b80: 2020 2020 4120 3d20 6461 7461 6672 616d      A = datafram
-00001b90: 652e 636f 7079 2829 0d0a 2020 2020 4120  e.copy()..    A 
-00001ba0: 3d20 412e 6472 6f70 6e61 2829 0d0a 2020  = A.dropna()..  
-00001bb0: 2020 412e 696e 6465 7820 3d20 7261 6e67    A.index = rang
-00001bc0: 6528 312c 412e 7368 6170 655b 305d 2b31  e(1,A.shape[0]+1
-00001bd0: 290d 0a20 2020 2073 7475 6465 6e74 697a  )..    studentiz
-00001be0: 6564 5f72 6573 6964 7561 6c73 203d 206d  ed_residuals = m
-00001bf0: 6f64 656c 2e67 6574 5f69 6e66 6c75 656e  odel.get_influen
-00001c00: 6365 2829 2e72 6573 6964 5f73 7475 6465  ce().resid_stude
-00001c10: 6e74 697a 6564 5f69 6e74 6572 6e61 6c0d  ntized_internal.
-00001c20: 0a20 2020 2041 5b22 4578 7065 6374 5072  .    A["ExpectPr
-00001c30: 6f66 6974 225d 203d 206d 6f64 656c 2e66  ofit"] = model.f
-00001c40: 6974 7465 6476 616c 7565 730d 0a20 2020  ittedvalues..   
-00001c50: 2069 6620 5479 7065 203d 3d20 276e 6567   if Type == 'neg
-00001c60: 273a 0d0a 2020 2020 2020 2020 7265 7475  ':..        retu
-00001c70: 726e 2841 5b5b 224c 6f63 6174 696f 6e22  rn(A[["Location"
-00001c80: 2c22 4578 7065 6374 5072 6f66 6974 222c  ,"ExpectProfit",
-00001c90: 2250 726f 6669 7422 5d5d 5b73 7475 6465  "Profit"]][stude
-00001ca0: 6e74 697a 6564 5f72 6573 6964 7561 6c73  ntized_residuals
-00001cb0: 3c2d 325d 290d 0a20 2020 2065 6c69 6620  <-2])..    elif 
-00001cc0: 5479 7065 203d 3d20 2770 6f73 6927 3a0d  Type == 'posi':.
-00001cd0: 0a20 2020 2020 2020 2072 6574 7572 6e28  .        return(
-00001ce0: 415b 5b22 4c6f 6361 7469 6f6e 222c 2245  A[["Location","E
-00001cf0: 7870 6563 7450 726f 6669 7422 2c22 5072  xpectProfit","Pr
-00001d00: 6f66 6974 225d 5d5b 7374 7564 656e 7469  ofit"]][studenti
-00001d10: 7a65 645f 7265 7369 6475 616c 733e 325d  zed_residuals>2]
-00001d20: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
-00001d30: 2020 2020 2020 7265 7475 726e 2841 5b5b        return(A[[
-00001d40: 224c 6f63 6174 696f 6e22 2c22 4578 7065  "Location","Expe
-00001d50: 6374 5072 6f66 6974 222c 2250 726f 6669  ctProfit","Profi
-00001d60: 7422 5d5d 5b6e 702e 6162 7328 7374 7564  t"]][np.abs(stud
-00001d70: 656e 7469 7a65 645f 7265 7369 6475 616c  entized_residual
-00001d80: 7329 3e32 5d29 0d0a 0d0a 6465 6620 6765  s)>2])....def ge
-00001d90: 7476 6966 2858 293a 0d0a 2020 2020 5820  tvif(X):..    X 
-00001da0: 3d20 736d 2e61 6464 5f63 6f6e 7374 616e  = sm.add_constan
-00001db0: 7428 5829 0d0a 2020 2020 7669 6620 3d20  t(X)..    vif = 
-00001dc0: 7064 2e44 6174 6146 7261 6d65 2829 0d0a  pd.DataFrame()..
-00001dd0: 2020 2020 7669 665b 2256 4946 225d 203d      vif["VIF"] =
-00001de0: 205b 7661 7269 616e 6365 5f69 6e66 6c61   [variance_infla
-00001df0: 7469 6f6e 5f66 6163 746f 7228 582e 7661  tion_factor(X.va
-00001e00: 6c75 6573 2c20 6929 2066 6f72 2069 2069  lues, i) for i i
-00001e10: 6e20 7261 6e67 6528 582e 7368 6170 655b  n range(X.shape[
-00001e20: 315d 295d 0d0a 2020 2020 7669 665b 2250  1])]..    vif["P
-00001e30: 7265 6469 6374 6f72 7322 5d20 3d20 582e  redictors"] = X.
-00001e40: 636f 6c75 6d6e 730d 0a20 2020 2072 6574  columns..    ret
-00001e50: 7572 6e28 7669 662e 6472 6f70 2869 6e64  urn(vif.drop(ind
-00001e60: 6578 203d 2030 292e 726f 756e 6428 3229  ex = 0).round(2)
-00001e70: 290d 0a64 6566 2072 6573 6964 7561 6c5f  )..def residual_
-00001e80: 706c 6f74 286d 6f64 656c 293a 0d0a 2020  plot(model):..  
-00001e90: 2020 6669 7474 6564 5f79 203d 206d 6f64    fitted_y = mod
-00001ea0: 656c 2e66 6974 7465 6476 616c 7565 730d  el.fittedvalues.
-00001eb0: 0a20 2020 2073 7475 6465 6e74 697a 6564  .    studentized
-00001ec0: 5f72 6573 6964 7561 6c73 203d 206d 6f64  _residuals = mod
-00001ed0: 656c 2e67 6574 5f69 6e66 6c75 656e 6365  el.get_influence
-00001ee0: 2829 2e72 6573 6964 5f73 7475 6465 6e74  ().resid_student
-00001ef0: 697a 6564 5f69 6e74 6572 6e61 6c0d 0a20  ized_internal.. 
-00001f00: 2020 2070 6c74 2e66 6967 7572 6528 6669     plt.figure(fi
-00001f10: 6773 697a 653d 2831 302c 3130 2929 0d0a  gsize=(10,10))..
-00001f20: 2020 2020 6178 3120 3d20 706c 742e 7375      ax1 = plt.su
-00001f30: 6270 6c6f 7428 3232 3129 0d0a 2020 2020  bplot(221)..    
-00001f40: 7374 6174 732e 7072 6f62 706c 6f74 2873  stats.probplot(s
-00001f50: 7475 6465 6e74 697a 6564 5f72 6573 6964  tudentized_resid
-00001f60: 7561 6c73 2c20 6469 7374 3d22 6e6f 726d  uals, dist="norm
-00001f70: 222c 2070 6c6f 743d 706c 7429 0d0a 2020  ", plot=plt)..  
-00001f80: 2020 6178 312e 7365 745f 7469 746c 6528    ax1.set_title(
-00001f90: 274e 6f72 6d61 6c20 512d 5127 290d 0a20  'Normal Q-Q').. 
-00001fa0: 2020 2061 7831 2e73 6574 5f78 6c61 6265     ax1.set_xlabe
-00001fb0: 6c28 274e 6f72 6d61 6c20 5175 616e 7469  l('Normal Quanti
-00001fc0: 6c65 7327 290d 0a20 2020 2061 7831 2e73  les')..    ax1.s
-00001fd0: 6574 5f79 6c61 6265 6c28 2753 7475 6465  et_ylabel('Stude
-00001fe0: 6e74 697a 6564 2052 6573 6964 7561 6c73  ntized Residuals
-00001ff0: 2729 3b0d 0a0d 0a20 2020 2061 7832 203d  ');....    ax2 =
-00002000: 2070 6c74 2e73 7562 706c 6f74 2832 3232   plt.subplot(222
-00002010: 290d 0a20 2020 2061 7832 2e68 6973 7428  )..    ax2.hist(
-00002020: 7374 7564 656e 7469 7a65 645f 7265 7369  studentized_resi
-00002030: 6475 616c 7329 0d0a 2020 2020 6178 322e  duals)..    ax2.
-00002040: 7365 745f 786c 6162 656c 2827 5374 7564  set_xlabel('Stud
-00002050: 656e 7469 7a65 6420 5265 7369 6475 616c  entized Residual
-00002060: 7327 290d 0a20 2020 2061 7832 2e73 6574  s')..    ax2.set
-00002070: 5f79 6c61 6265 6c28 2743 6f75 6e74 2729  _ylabel('Count')
-00002080: 0d0a 2020 2020 6178 322e 7365 745f 7469  ..    ax2.set_ti
-00002090: 746c 6528 2748 6973 746f 6772 616d 2729  tle('Histogram')
-000020a0: 0d0a 0d0a 2020 2020 6178 3320 3d20 706c  ....    ax3 = pl
-000020b0: 742e 7375 6270 6c6f 7428 3232 3329 0d0a  t.subplot(223)..
-000020c0: 2020 2020 7420 3d20 7261 6e67 6528 6c65      t = range(le
-000020d0: 6e28 6669 7474 6564 5f79 2929 0d0a 2020  n(fitted_y))..  
-000020e0: 2020 6178 332e 7363 6174 7465 7228 742c    ax3.scatter(t,
-000020f0: 2073 7475 6465 6e74 697a 6564 5f72 6573   studentized_res
-00002100: 6964 7561 6c73 290d 0a20 2020 2061 7833  iduals)..    ax3
-00002110: 2e73 6574 5f78 6c61 6265 6c28 274f 6273  .set_xlabel('Obs
-00002120: 6572 7661 7469 6f6e 206f 7264 6572 2729  ervation order')
-00002130: 0d0a 2020 2020 6178 332e 7365 745f 796c  ..    ax3.set_yl
-00002140: 6162 656c 2827 5265 7369 6475 616c 7327  abel('Residuals'
-00002150: 290d 0a20 2020 2061 7833 2e73 6574 5f74  )..    ax3.set_t
-00002160: 6974 6c65 2827 5469 6d65 2073 6572 6965  itle('Time serie
-00002170: 7320 706c 6f74 206f 6620 7265 7369 6475  s plot of residu
-00002180: 616c 7327 290d 0a0d 0a20 2020 2061 7834  als')....    ax4
-00002190: 203d 2070 6c74 2e73 7562 706c 6f74 2832   = plt.subplot(2
-000021a0: 3234 290d 0a20 2020 2061 7834 203d 2073  24)..    ax4 = s
-000021b0: 6e73 2e72 6573 6964 706c 6f74 2878 3d66  ns.residplot(x=f
-000021c0: 6974 7465 645f 792c 2079 3d73 7475 6465  itted_y, y=stude
-000021d0: 6e74 697a 6564 5f72 6573 6964 7561 6c73  ntized_residuals
-000021e0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000021f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002200: 206c 6f77 6573 733d 5472 7565 2c0d 0a20   lowess=True,.. 
-00002210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002220: 2020 2020 2020 2020 2020 2020 2073 6361               sca
-00002230: 7474 6572 5f6b 7773 3d7b 2761 6c70 6861  tter_kws={'alpha
-00002240: 273a 2030 2e35 7d2c 0d0a 2020 2020 2020  ': 0.5},..      
-00002250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002260: 2020 2020 2020 2020 6c69 6e65 5f6b 7773          line_kws
-00002270: 3d7b 2763 6f6c 6f72 273a 2027 7265 6427  ={'color': 'red'
-00002280: 2c20 276c 7727 3a20 312c 2027 616c 7068  , 'lw': 1, 'alph
-00002290: 6127 3a20 302e 387d 290d 0a20 2020 2061  a': 0.8})..    a
-000022a0: 7834 2e73 6574 5f74 6974 6c65 2827 5374  x4.set_title('St
-000022b0: 7564 656e 7469 7a65 6420 5265 7369 6475  udentized Residu
-000022c0: 616c 7320 7673 2046 6974 7465 6420 7661  als vs Fitted va
-000022d0: 6c75 6573 2729 0d0a 2020 2020 6178 342e  lues')..    ax4.
-000022e0: 7365 745f 786c 6162 656c 2827 4669 7474  set_xlabel('Fitt
-000022f0: 6564 2076 616c 7565 7327 290d 0a20 2020  ed values')..   
-00002300: 2061 7834 2e73 6574 5f79 6c61 6265 6c28   ax4.set_ylabel(
-00002310: 2753 7475 6465 6e74 697a 6564 2052 6573  'Studentized Res
-00002320: 6964 7561 6c73 2729 3b                   iduals');
+00001380: 2020 2020 2074 6872 6573 686f 6c64 5f6f       threshold_o
+00001390: 7574 203d 2030 2e30 352c 0d0a 2020 2020  ut = 0.05,..    
+000013a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000013b0: 2020 2076 6572 626f 7365 3d54 7275 6529     verbose=True)
+000013c0: 3a0d 0a20 2020 2022 2222 2050 6572 666f  :..    """ Perfo
+000013d0: 726d 2061 2066 6f72 7761 7264 2d62 6163  rm a forward-bac
+000013e0: 6b77 6172 6420 6665 6174 7572 6520 7365  kward feature se
+000013f0: 6c65 6374 696f 6e0d 0a20 2020 2062 6173  lection..    bas
+00001400: 6564 206f 6e20 702d 7661 6c75 6520 6672  ed on p-value fr
+00001410: 6f6d 2073 7461 7473 6d6f 6465 6c73 2e61  om statsmodels.a
+00001420: 7069 2e4f 4c53 0d0a 2020 2020 4172 6775  pi.OLS..    Argu
+00001430: 6d65 6e74 733a 0d0a 2020 2020 2020 2020  ments:..        
+00001440: 5820 2d20 7061 6e64 6173 2e44 6174 6146  X - pandas.DataF
+00001450: 7261 6d65 2077 6974 6820 6361 6e64 6964  rame with candid
+00001460: 6174 6520 6665 6174 7572 6573 0d0a 2020  ate features..  
+00001470: 2020 2020 2020 7920 2d20 6c69 7374 2d6c        y - list-l
+00001480: 696b 6520 7769 7468 2074 6865 2074 6172  ike with the tar
+00001490: 6765 740d 0a20 2020 2020 2020 2069 6e69  get..        ini
+000014a0: 7469 616c 5f6c 6973 7420 2d20 6c69 7374  tial_list - list
+000014b0: 206f 6620 6665 6174 7572 6573 2074 6f20   of features to 
+000014c0: 7374 6172 7420 7769 7468 2028 636f 6c75  start with (colu
+000014d0: 6d6e 206e 616d 6573 206f 6620 5829 0d0a  mn names of X)..
+000014e0: 2020 2020 2020 2020 7468 7265 7368 6f6c          threshol
+000014f0: 645f 696e 202d 2069 6e63 6c75 6465 2061  d_in - include a
+00001500: 2066 6561 7475 7265 2069 6620 6974 7320   feature if its 
+00001510: 702d 7661 6c75 6520 3c20 7468 7265 7368  p-value < thresh
+00001520: 6f6c 645f 696e 0d0a 2020 2020 2020 2020  old_in..        
+00001530: 7468 7265 7368 6f6c 645f 6f75 7420 2d20  threshold_out - 
+00001540: 6578 636c 7564 6520 6120 6665 6174 7572  exclude a featur
+00001550: 6520 6966 2069 7473 2070 2d76 616c 7565  e if its p-value
+00001560: 203e 2074 6872 6573 686f 6c64 5f6f 7574   > threshold_out
+00001570: 0d0a 2020 2020 2020 2020 7665 7262 6f73  ..        verbos
+00001580: 6520 2d20 7768 6574 6865 7220 746f 2070  e - whether to p
+00001590: 7269 6e74 2074 6865 2073 6571 7565 6e63  rint the sequenc
+000015a0: 6520 6f66 2069 6e63 6c75 7369 6f6e 7320  e of inclusions 
+000015b0: 616e 6420 6578 636c 7573 696f 6e73 0d0a  and exclusions..
+000015c0: 2020 2020 5265 7475 726e 733a 206c 6973      Returns: lis
+000015d0: 7420 6f66 2073 656c 6563 7465 6420 6665  t of selected fe
+000015e0: 6174 7572 6573 0d0a 2020 2020 416c 7761  atures..    Alwa
+000015f0: 7973 2073 6574 2074 6872 6573 686f 6c64  ys set threshold
+00001600: 5f69 6e20 3c20 7468 7265 7368 6f6c 645f  _in < threshold_
+00001610: 6f75 7420 746f 2061 766f 6964 2069 6e66  out to avoid inf
+00001620: 696e 6974 6520 6c6f 6f70 696e 672e 0d0a  inite looping...
+00001630: 2020 2020 5365 6520 6874 7470 733a 2f2f      See https://
+00001640: 656e 2e77 696b 6970 6564 6961 2e6f 7267  en.wikipedia.org
+00001650: 2f77 696b 692f 5374 6570 7769 7365 5f72  /wiki/Stepwise_r
+00001660: 6567 7265 7373 696f 6e20 666f 7220 7468  egression for th
+00001670: 6520 6465 7461 696c 730d 0a20 2020 2022  e details..    "
+00001680: 2222 0d0a 2020 2020 696e 636c 7564 6564  ""..    included
+00001690: 203d 206c 6973 7428 696e 6974 6961 6c5f   = list(initial_
+000016a0: 6c69 7374 290d 0a20 2020 2077 6869 6c65  list)..    while
+000016b0: 2054 7275 653a 0d0a 2020 2020 2020 2020   True:..        
+000016c0: 6368 616e 6765 643d 4661 6c73 650d 0a20  changed=False.. 
+000016d0: 2020 2020 2020 2023 2066 6f72 7761 7264         # forward
+000016e0: 2073 7465 700d 0a20 2020 2020 2020 2065   step..        e
+000016f0: 7863 6c75 6465 6420 3d20 6c69 7374 2873  xcluded = list(s
+00001700: 6574 2858 2e63 6f6c 756d 6e73 292d 7365  et(X.columns)-se
+00001710: 7428 696e 636c 7564 6564 2929 0d0a 2020  t(included))..  
+00001720: 2020 2020 2020 6e65 775f 7076 616c 203d        new_pval =
+00001730: 2070 642e 5365 7269 6573 2869 6e64 6578   pd.Series(index
+00001740: 3d65 7863 6c75 6465 6429 0d0a 2020 2020  =excluded)..    
+00001750: 2020 2020 666f 7220 6e65 775f 636f 6c75      for new_colu
+00001760: 6d6e 2069 6e20 6578 636c 7564 6564 3a0d  mn in excluded:.
+00001770: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00001780: 656c 203d 2073 6d2e 4f4c 5328 792c 2073  el = sm.OLS(y, s
+00001790: 6d2e 6164 645f 636f 6e73 7461 6e74 2870  m.add_constant(p
+000017a0: 642e 4461 7461 4672 616d 6528 585b 696e  d.DataFrame(X[in
+000017b0: 636c 7564 6564 2b5b 6e65 775f 636f 6c75  cluded+[new_colu
+000017c0: 6d6e 5d5d 2929 292e 6669 7428 290d 0a20  mn]]))).fit().. 
+000017d0: 2020 2020 2020 2020 2020 206e 6577 5f70             new_p
+000017e0: 7661 6c5b 6e65 775f 636f 6c75 6d6e 5d20  val[new_column] 
+000017f0: 3d20 6d6f 6465 6c2e 7076 616c 7565 735b  = model.pvalues[
+00001800: 6e65 775f 636f 6c75 6d6e 5d0d 0a20 2020  new_column]..   
+00001810: 2020 2020 2062 6573 745f 7076 616c 203d       best_pval =
+00001820: 206e 6577 5f70 7661 6c2e 6d69 6e28 290d   new_pval.min().
+00001830: 0a20 2020 2020 2020 2069 6620 6265 7374  .        if best
+00001840: 5f70 7661 6c20 3c20 7468 7265 7368 6f6c  _pval < threshol
+00001850: 645f 696e 3a0d 0a20 2020 2020 2020 2020  d_in:..         
+00001860: 2020 2062 6573 745f 6665 6174 7572 6520     best_feature 
+00001870: 3d20 6e65 775f 7076 616c 2e69 6478 6d69  = new_pval.idxmi
+00001880: 6e28 290d 0a20 2020 2020 2020 2020 2020  n()..           
+00001890: 2069 6e63 6c75 6465 642e 6170 7065 6e64   included.append
+000018a0: 2862 6573 745f 6665 6174 7572 6529 0d0a  (best_feature)..
+000018b0: 2020 2020 2020 2020 2020 2020 6368 616e              chan
+000018c0: 6765 643d 5472 7565 0d0a 2020 2020 2020  ged=True..      
+000018d0: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
+000018e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000018f0: 2020 2070 7269 6e74 2827 4164 6420 207b     print('Add  {
+00001900: 3a33 307d 2077 6974 6820 702d 7661 6c75  :30} with p-valu
+00001910: 6520 7b3a 2e36 7d27 2e66 6f72 6d61 7428  e {:.6}'.format(
+00001920: 6265 7374 5f66 6561 7475 7265 2c20 6265  best_feature, be
+00001930: 7374 5f70 7661 6c29 290d 0a0d 0a20 2020  st_pval))....   
+00001940: 2020 2020 2023 2062 6163 6b77 6172 6420       # backward 
+00001950: 7374 6570 0d0a 2020 2020 2020 2020 6d6f  step..        mo
+00001960: 6465 6c20 3d20 736d 2e4f 4c53 2879 2c20  del = sm.OLS(y, 
+00001970: 736d 2e61 6464 5f63 6f6e 7374 616e 7428  sm.add_constant(
+00001980: 7064 2e44 6174 6146 7261 6d65 2858 5b69  pd.DataFrame(X[i
+00001990: 6e63 6c75 6465 645d 2929 292e 6669 7428  ncluded]))).fit(
+000019a0: 290d 0a20 2020 2020 2020 2023 2075 7365  )..        # use
+000019b0: 2061 6c6c 2063 6f65 6673 2065 7863 6570   all coefs excep
+000019c0: 7420 696e 7465 7263 6570 740d 0a20 2020  t intercept..   
+000019d0: 2020 2020 2070 7661 6c75 6573 203d 206d       pvalues = m
+000019e0: 6f64 656c 2e70 7661 6c75 6573 2e69 6c6f  odel.pvalues.ilo
+000019f0: 635b 313a 5d0d 0a20 2020 2020 2020 2077  c[1:]..        w
+00001a00: 6f72 7374 5f70 7661 6c20 3d20 7076 616c  orst_pval = pval
+00001a10: 7565 732e 6d61 7828 2920 2320 6e75 6c6c  ues.max() # null
+00001a20: 2069 6620 7076 616c 7565 7320 6973 2065   if pvalues is e
+00001a30: 6d70 7479 0d0a 2020 2020 2020 2020 6966  mpty..        if
+00001a40: 2077 6f72 7374 5f70 7661 6c20 3e20 7468   worst_pval > th
+00001a50: 7265 7368 6f6c 645f 6f75 743a 0d0a 2020  reshold_out:..  
+00001a60: 2020 2020 2020 2020 2020 6368 616e 6765            change
+00001a70: 643d 5472 7565 0d0a 2020 2020 2020 2020  d=True..        
+00001a80: 2020 2020 776f 7273 745f 6665 6174 7572      worst_featur
+00001a90: 6520 3d20 7076 616c 7565 732e 6964 786d  e = pvalues.idxm
+00001aa0: 6178 2829 0d0a 2020 2020 2020 2020 2020  ax()..          
+00001ab0: 2020 696e 636c 7564 6564 2e72 656d 6f76    included.remov
+00001ac0: 6528 776f 7273 745f 6665 6174 7572 6529  e(worst_feature)
+00001ad0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00001ae0: 2076 6572 626f 7365 3a0d 0a20 2020 2020   verbose:..     
+00001af0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00001b00: 2827 4472 6f70 207b 3a33 307d 2077 6974  ('Drop {:30} wit
+00001b10: 6820 702d 7661 6c75 6520 7b3a 2e36 7d27  h p-value {:.6}'
+00001b20: 2e66 6f72 6d61 7428 776f 7273 745f 6665  .format(worst_fe
+00001b30: 6174 7572 652c 2077 6f72 7374 5f70 7661  ature, worst_pva
+00001b40: 6c29 290d 0a20 2020 2020 2020 2069 6620  l))..        if 
+00001b50: 6e6f 7420 6368 616e 6765 643a 0d0a 2020  not changed:..  
+00001b60: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
+00001b70: 0a20 2020 2072 6574 7572 6e20 696e 636c  .    return incl
+00001b80: 7564 6564 0d0a 6465 6620 6f75 746c 6965  uded..def outlie
+00001b90: 7228 6461 7461 6672 616d 652c 6d6f 6465  r(dataframe,mode
+00001ba0: 6c2c 5479 7065 3d27 616c 6c27 293a 0d0a  l,Type='all'):..
+00001bb0: 2020 2020 4120 3d20 6461 7461 6672 616d      A = datafram
+00001bc0: 652e 636f 7079 2829 0d0a 2020 2020 4120  e.copy()..    A 
+00001bd0: 3d20 412e 6472 6f70 6e61 2829 0d0a 2020  = A.dropna()..  
+00001be0: 2020 412e 696e 6465 7820 3d20 7261 6e67    A.index = rang
+00001bf0: 6528 312c 412e 7368 6170 655b 305d 2b31  e(1,A.shape[0]+1
+00001c00: 290d 0a20 2020 2073 7475 6465 6e74 697a  )..    studentiz
+00001c10: 6564 5f72 6573 6964 7561 6c73 203d 206d  ed_residuals = m
+00001c20: 6f64 656c 2e67 6574 5f69 6e66 6c75 656e  odel.get_influen
+00001c30: 6365 2829 2e72 6573 6964 5f73 7475 6465  ce().resid_stude
+00001c40: 6e74 697a 6564 5f69 6e74 6572 6e61 6c0d  ntized_internal.
+00001c50: 0a20 2020 2041 5b22 4578 7065 6374 5072  .    A["ExpectPr
+00001c60: 6f66 6974 225d 203d 206d 6f64 656c 2e66  ofit"] = model.f
+00001c70: 6974 7465 6476 616c 7565 730d 0a20 2020  ittedvalues..   
+00001c80: 2069 6620 5479 7065 203d 3d20 276e 6567   if Type == 'neg
+00001c90: 273a 0d0a 2020 2020 2020 2020 7265 7475  ':..        retu
+00001ca0: 726e 2841 5b5b 224c 6f63 6174 696f 6e22  rn(A[["Location"
+00001cb0: 2c22 4578 7065 6374 5072 6f66 6974 222c  ,"ExpectProfit",
+00001cc0: 2250 726f 6669 7422 5d5d 5b73 7475 6465  "Profit"]][stude
+00001cd0: 6e74 697a 6564 5f72 6573 6964 7561 6c73  ntized_residuals
+00001ce0: 3c2d 325d 290d 0a20 2020 2065 6c69 6620  <-2])..    elif 
+00001cf0: 5479 7065 203d 3d20 2770 6f73 6927 3a0d  Type == 'posi':.
+00001d00: 0a20 2020 2020 2020 2072 6574 7572 6e28  .        return(
+00001d10: 415b 5b22 4c6f 6361 7469 6f6e 222c 2245  A[["Location","E
+00001d20: 7870 6563 7450 726f 6669 7422 2c22 5072  xpectProfit","Pr
+00001d30: 6f66 6974 225d 5d5b 7374 7564 656e 7469  ofit"]][studenti
+00001d40: 7a65 645f 7265 7369 6475 616c 733e 325d  zed_residuals>2]
+00001d50: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+00001d60: 2020 2020 2020 7265 7475 726e 2841 5b5b        return(A[[
+00001d70: 224c 6f63 6174 696f 6e22 2c22 4578 7065  "Location","Expe
+00001d80: 6374 5072 6f66 6974 222c 2250 726f 6669  ctProfit","Profi
+00001d90: 7422 5d5d 5b6e 702e 6162 7328 7374 7564  t"]][np.abs(stud
+00001da0: 656e 7469 7a65 645f 7265 7369 6475 616c  entized_residual
+00001db0: 7329 3e32 5d29 0d0a 0d0a 6465 6620 6765  s)>2])....def ge
+00001dc0: 7476 6966 2858 293a 0d0a 2020 2020 5820  tvif(X):..    X 
+00001dd0: 3d20 736d 2e61 6464 5f63 6f6e 7374 616e  = sm.add_constan
+00001de0: 7428 5829 0d0a 2020 2020 7669 6620 3d20  t(X)..    vif = 
+00001df0: 7064 2e44 6174 6146 7261 6d65 2829 0d0a  pd.DataFrame()..
+00001e00: 2020 2020 7669 665b 2256 4946 225d 203d      vif["VIF"] =
+00001e10: 205b 7661 7269 616e 6365 5f69 6e66 6c61   [variance_infla
+00001e20: 7469 6f6e 5f66 6163 746f 7228 582e 7661  tion_factor(X.va
+00001e30: 6c75 6573 2c20 6929 2066 6f72 2069 2069  lues, i) for i i
+00001e40: 6e20 7261 6e67 6528 582e 7368 6170 655b  n range(X.shape[
+00001e50: 315d 295d 0d0a 2020 2020 7669 665b 2250  1])]..    vif["P
+00001e60: 7265 6469 6374 6f72 7322 5d20 3d20 582e  redictors"] = X.
+00001e70: 636f 6c75 6d6e 730d 0a20 2020 2072 6574  columns..    ret
+00001e80: 7572 6e28 7669 662e 6472 6f70 2869 6e64  urn(vif.drop(ind
+00001e90: 6578 203d 2030 292e 726f 756e 6428 3229  ex = 0).round(2)
+00001ea0: 290d 0a64 6566 2072 6573 6964 7561 6c5f  )..def residual_
+00001eb0: 706c 6f74 286d 6f64 656c 293a 0d0a 2020  plot(model):..  
+00001ec0: 2020 6669 7474 6564 5f79 203d 206d 6f64    fitted_y = mod
+00001ed0: 656c 2e66 6974 7465 6476 616c 7565 730d  el.fittedvalues.
+00001ee0: 0a20 2020 2073 7475 6465 6e74 697a 6564  .    studentized
+00001ef0: 5f72 6573 6964 7561 6c73 203d 206d 6f64  _residuals = mod
+00001f00: 656c 2e67 6574 5f69 6e66 6c75 656e 6365  el.get_influence
+00001f10: 2829 2e72 6573 6964 5f73 7475 6465 6e74  ().resid_student
+00001f20: 697a 6564 5f69 6e74 6572 6e61 6c0d 0a20  ized_internal.. 
+00001f30: 2020 2070 6c74 2e66 6967 7572 6528 6669     plt.figure(fi
+00001f40: 6773 697a 653d 2831 302c 3130 2929 0d0a  gsize=(10,10))..
+00001f50: 2020 2020 6178 3120 3d20 706c 742e 7375      ax1 = plt.su
+00001f60: 6270 6c6f 7428 3232 3129 0d0a 2020 2020  bplot(221)..    
+00001f70: 7374 6174 732e 7072 6f62 706c 6f74 2873  stats.probplot(s
+00001f80: 7475 6465 6e74 697a 6564 5f72 6573 6964  tudentized_resid
+00001f90: 7561 6c73 2c20 6469 7374 3d22 6e6f 726d  uals, dist="norm
+00001fa0: 222c 2070 6c6f 743d 706c 7429 0d0a 2020  ", plot=plt)..  
+00001fb0: 2020 6178 312e 7365 745f 7469 746c 6528    ax1.set_title(
+00001fc0: 274e 6f72 6d61 6c20 512d 5127 290d 0a20  'Normal Q-Q').. 
+00001fd0: 2020 2061 7831 2e73 6574 5f78 6c61 6265     ax1.set_xlabe
+00001fe0: 6c28 274e 6f72 6d61 6c20 5175 616e 7469  l('Normal Quanti
+00001ff0: 6c65 7327 290d 0a20 2020 2061 7831 2e73  les')..    ax1.s
+00002000: 6574 5f79 6c61 6265 6c28 2753 7475 6465  et_ylabel('Stude
+00002010: 6e74 697a 6564 2052 6573 6964 7561 6c73  ntized Residuals
+00002020: 2729 3b0d 0a0d 0a20 2020 2061 7832 203d  ');....    ax2 =
+00002030: 2070 6c74 2e73 7562 706c 6f74 2832 3232   plt.subplot(222
+00002040: 290d 0a20 2020 2061 7832 2e68 6973 7428  )..    ax2.hist(
+00002050: 7374 7564 656e 7469 7a65 645f 7265 7369  studentized_resi
+00002060: 6475 616c 7329 0d0a 2020 2020 6178 322e  duals)..    ax2.
+00002070: 7365 745f 786c 6162 656c 2827 5374 7564  set_xlabel('Stud
+00002080: 656e 7469 7a65 6420 5265 7369 6475 616c  entized Residual
+00002090: 7327 290d 0a20 2020 2061 7832 2e73 6574  s')..    ax2.set
+000020a0: 5f79 6c61 6265 6c28 2743 6f75 6e74 2729  _ylabel('Count')
+000020b0: 0d0a 2020 2020 6178 322e 7365 745f 7469  ..    ax2.set_ti
+000020c0: 746c 6528 2748 6973 746f 6772 616d 2729  tle('Histogram')
+000020d0: 0d0a 0d0a 2020 2020 6178 3320 3d20 706c  ....    ax3 = pl
+000020e0: 742e 7375 6270 6c6f 7428 3232 3329 0d0a  t.subplot(223)..
+000020f0: 2020 2020 7420 3d20 7261 6e67 6528 6c65      t = range(le
+00002100: 6e28 6669 7474 6564 5f79 2929 0d0a 2020  n(fitted_y))..  
+00002110: 2020 6178 332e 7363 6174 7465 7228 742c    ax3.scatter(t,
+00002120: 2073 7475 6465 6e74 697a 6564 5f72 6573   studentized_res
+00002130: 6964 7561 6c73 290d 0a20 2020 2061 7833  iduals)..    ax3
+00002140: 2e73 6574 5f78 6c61 6265 6c28 274f 6273  .set_xlabel('Obs
+00002150: 6572 7661 7469 6f6e 206f 7264 6572 2729  ervation order')
+00002160: 0d0a 2020 2020 6178 332e 7365 745f 796c  ..    ax3.set_yl
+00002170: 6162 656c 2827 5265 7369 6475 616c 7327  abel('Residuals'
+00002180: 290d 0a20 2020 2061 7833 2e73 6574 5f74  )..    ax3.set_t
+00002190: 6974 6c65 2827 5469 6d65 2073 6572 6965  itle('Time serie
+000021a0: 7320 706c 6f74 206f 6620 7265 7369 6475  s plot of residu
+000021b0: 616c 7327 290d 0a0d 0a20 2020 2061 7834  als')....    ax4
+000021c0: 203d 2070 6c74 2e73 7562 706c 6f74 2832   = plt.subplot(2
+000021d0: 3234 290d 0a20 2020 2061 7834 203d 2073  24)..    ax4 = s
+000021e0: 6e73 2e72 6573 6964 706c 6f74 2878 3d66  ns.residplot(x=f
+000021f0: 6974 7465 645f 792c 2079 3d73 7475 6465  itted_y, y=stude
+00002200: 6e74 697a 6564 5f72 6573 6964 7561 6c73  ntized_residuals
+00002210: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00002220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002230: 206c 6f77 6573 733d 5472 7565 2c0d 0a20   lowess=True,.. 
+00002240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002250: 2020 2020 2020 2020 2020 2020 2073 6361               sca
+00002260: 7474 6572 5f6b 7773 3d7b 2761 6c70 6861  tter_kws={'alpha
+00002270: 273a 2030 2e35 7d2c 0d0a 2020 2020 2020  ': 0.5},..      
+00002280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002290: 2020 2020 2020 2020 6c69 6e65 5f6b 7773          line_kws
+000022a0: 3d7b 2763 6f6c 6f72 273a 2027 7265 6427  ={'color': 'red'
+000022b0: 2c20 276c 7727 3a20 312c 2027 616c 7068  , 'lw': 1, 'alph
+000022c0: 6127 3a20 302e 387d 290d 0a20 2020 2061  a': 0.8})..    a
+000022d0: 7834 2e73 6574 5f74 6974 6c65 2827 5374  x4.set_title('St
+000022e0: 7564 656e 7469 7a65 6420 5265 7369 6475  udentized Residu
+000022f0: 616c 7320 7673 2046 6974 7465 6420 7661  als vs Fitted va
+00002300: 6c75 6573 2729 0d0a 2020 2020 6178 342e  lues')..    ax4.
+00002310: 7365 745f 786c 6162 656c 2827 4669 7474  set_xlabel('Fitt
+00002320: 6564 2076 616c 7565 7327 290d 0a20 2020  ed values')..   
+00002330: 2061 7834 2e73 6574 5f79 6c61 6265 6c28   ax4.set_ylabel(
+00002340: 2753 7475 6465 6e74 697a 6564 2052 6573  'Studentized Res
+00002350: 6964 7561 6c73 2729 3b                   iduals');
```

